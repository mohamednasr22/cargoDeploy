(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{GTCo:function(t,e,i){"use strict";i.r(e),i.d(e,"ShipmentModule",function(){return Vi});var n=i("SVse"),a=i("iInd"),o=i("8Y7J"),c=i("OaSA"),s=i("CtHx"),r=i("s7LF"),b=i("wd/R"),l=i("Sftj"),d=i("AXEG"),m=i("PZgd"),p=i("LUZP"),h=i("5QHs"),u=i("XNiG"),g=i("VRyK"),f=i("LRne"),_=i("vkgz"),C=i("Kj3r"),T=i("JX91"),U=i("eIep"),M=i("lJxs"),v=i("JIr8"),y=i("iELJ"),O=i("zHaW"),P=i("M6PE"),w=i("Tj54"),k=i("SqCe"),I=i("Q2Ze"),x=i("e6WT"),S=i("Dxy4");let F=(()=>{class t{constructor(t,e,i,n){this.dialogRef=t,this.data=e,this._snackBar=i,this.shipmentService=n,this.noteControl=new r.g,this.submitted=!1}ngOnInit(){this.noteControl.setValue(this.data.item.note)}submitForm(){this.submitted=!0;let t=new FormData;t.append("note",this.noteControl.value),this.data.item.shipment_id?(t.append("shipment_id",this.data.item.shipment_id.toString()),this.shipmentService.saveShipmentNotes(t).subscribe(t=>{this.data.item.note=this.noteControl.value,this.submitted=!1,this.onNoClick(),this.openSnackBar("Data submited successfully","")},t=>{this.submitted=!1,this.onNoClick(),this.openSnackBar("Something wrong happen!","")})):(this.submitted=!1,this.onNoClick())}openSnackBar(t,e){this._snackBar.open(t,e,{duration:2e3})}onNoClick(){this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(y.g),o.Ob(y.a),o.Ob(O.a),o.Ob(P.a))},t.\u0275cmp=o.Ib({type:t,selectors:[["app-shipmentnotes"]],decls:13,vars:2,consts:[["mat-dialog-title","",1,"pop_header"],["mat-list-icon",""],["mat-dialog-content",""],["appearance","fill"],["matInput","",3,"formControl"],["mat-dialog-actions",""],["mat-raised-button","","color","warn",3,"click"],["mat-button","",3,"click"]],template:function(t,e){1&t&&(o.Ub(0,"h2",0),o.Ub(1,"mat-icon",1),o.Mc(2,"edit"),o.Tb(),o.Mc(3," Update Your Notes"),o.Tb(),o.Ub(4,"div",2),o.Ub(5,"mat-form-field",3),o.Ub(6,"textarea",4),o.Mc(7),o.Tb(),o.Tb(),o.Tb(),o.Ub(8,"div",5),o.Ub(9,"button",6),o.cc("click",function(){return e.submitForm()}),o.Mc(10,"Update"),o.Tb(),o.Ub(11,"button",7),o.cc("click",function(){return e.onNoClick()}),o.Mc(12,"Close"),o.Tb(),o.Tb()),2&t&&(o.Cb(6),o.oc("formControl",e.noteControl),o.Cb(1),o.Nc(e.data.item.note))},directives:[y.h,w.a,k.b,y.e,I.b,x.b,r.d,r.q,r.h,y.c,S.b],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),t})();var N=i("I5r7"),D=i("5oI9"),K=i("ej43"),R=i("Wc6z"),A=i("ZTz/"),V=i("UhP/"),$=i("TN/R"),L=i("pu8Q"),j=i("rJgo"),Y=i("jsAG"),q=i("rYkZ");let E=(()=>{class t{transform(t,...e){let i="";return t<10?i="000":t<100?i="00":t<1e3&&(i="000"),`${i}${t}`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Nb({name:"zeroid",type:t,pure:!0}),t})(),H=(()=>{class t{transform(t,...e){return t?b(t.split("T")[0]).format("MM/DD/YYYY"):""}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Nb({name:"customdate",type:t,pure:!0}),t})();var G=i("X62f"),z=i("1Ob8");const B=["itemTemplate"],W=["content"];function J(t,e){if(1&t&&(o.Ub(0,"td"),o.Ub(1,"div"),o.Mc(2),o.Tb(),o.Ub(3,"div"),o.Ub(4,"b"),o.Mc(5),o.Tb(),o.Tb(),o.Tb()),2&t){const t=o.gc().package;o.Cb(2),o.Qc("",t.year," ",t.model," ",t.mark,""),o.Cb(3),o.Nc(t.vin)}}function Q(t,e){if(1&t&&(o.Ub(0,"td"),o.Ub(1,"div"),o.Mc(2),o.Tb(),o.Tb()),2&t){const t=o.gc().package;o.Cb(2),o.Nc(t.description)}}function Z(t,e){if(1&t&&(o.Kc(0,J,6,4,"td",11),o.Kc(1,Q,3,1,"td",11)),2&t){const t=e.package;o.oc("ngIf",1==t.type),o.Cb(1),o.oc("ngIf",2==t.type)}}function X(t,e){1&t&&(o.Ub(0,"a",51),o.Ub(1,"mat-icon",2),o.Mc(2,"add_circle_outline"),o.Tb(),o.Mc(3," Add Shipment "),o.Tb()),2&t&&o.oc("routerLink","/admin/shipments/add")}function tt(t,e){if(1&t&&(o.Ub(0,"mat-form-field"),o.Ub(1,"mat-label"),o.Mc(2,"Shipper Name"),o.Tb(),o.Pb(3,"input",10),o.Tb()),2&t){const t=o.gc();o.Cb(3),o.oc("formControl",t.shipperName)}}function et(t,e){if(1&t&&(o.Ub(0,"mat-option",52),o.Mc(1),o.Tb()),2&t){const t=e.$implicit;o.oc("value",t.id),o.Cb(1),o.Oc(" ",t.name," ")}}function it(t,e){if(1&t&&(o.Ub(0,"mat-option",52),o.Mc(1),o.Tb()),2&t){const t=e.$implicit;o.oc("value",t.id),o.Cb(1),o.Oc(" ",t.name," ")}}function nt(t,e){1&t&&o.Pb(0,"div")}function at(t,e){1&t&&o.Pb(0,"mat-spinner")}function ot(t,e){if(1&t&&(o.Ub(0,"div",53),o.Kc(1,at,1,0,"mat-spinner",11),o.Tb()),2&t){const t=o.gc();o.Cb(1),o.oc("ngIf",t.isLoadingResults)}}function ct(t,e){1&t&&(o.Ub(0,"th",54),o.Mc(1," Tracking ID "),o.Tb())}function st(t,e){if(1&t){const t=o.Vb();o.Ub(0,"td",55),o.cc("click",function(){o.Ac(t);const i=e.$implicit,n=o.gc();return n.expandedElement=n.expandedElement===i?null:i}),o.Mc(1),o.hc(2,"zeroid"),o.Tb()}if(2&t){const t=e.$implicit;o.Cb(1),o.Oc(" ",o.ic(2,1,t.shipment_id)," ")}}function rt(t,e){1&t&&(o.Ub(0,"th",56),o.Mc(1," Description "),o.Tb())}const bt=function(t){return{package:t}};function lt(t,e){if(1&t&&(o.Ub(0,"tr"),o.Qb(1,59),o.Tb()),2&t){const t=e.$implicit;o.gc(2);const i=o.xc(1);o.Cb(1),o.oc("ngTemplateOutlet",i)("ngTemplateOutletContext",o.sc(2,bt,t))}}function dt(t,e){if(1&t&&(o.Ub(0,"td",57),o.Ub(1,"table"),o.Kc(2,lt,2,4,"tr",58),o.Tb(),o.Tb()),2&t){const t=e.$implicit;o.Cb(2),o.oc("ngForOf",t.packages)}}function mt(t,e){1&t&&(o.Ub(0,"th",54),o.Mc(1," Date "),o.Tb())}function pt(t,e){if(1&t&&(o.Ub(0,"td",57),o.Mc(1),o.hc(2,"customdate"),o.Tb()),2&t){const t=e.$implicit;o.Cb(1),o.Oc(" ",o.ic(2,1,t.date)," ")}}function ht(t,e){1&t&&(o.Ub(0,"th",54),o.Mc(1," Shipper Name "),o.Tb())}function ut(t,e){if(1&t&&(o.Ub(0,"td",57),o.Mc(1),o.Tb()),2&t){const t=e.$implicit;o.Cb(1),o.Oc(" ",t.shipper_name," ")}}function gt(t,e){1&t&&(o.Ub(0,"th",54),o.Mc(1," Receiver Name "),o.Tb())}function ft(t,e){if(1&t&&(o.Ub(0,"td",57),o.Mc(1),o.Tb()),2&t){const t=e.$implicit;o.Cb(1),o.Oc(" ",t.receiver_name," ")}}function _t(t,e){1&t&&(o.Ub(0,"th",56),o.Mc(1," Destination "),o.Tb())}function Ct(t,e){if(1&t&&(o.Ub(0,"td",57),o.Mc(1),o.Tb()),2&t){const t=e.$implicit;o.Cb(1),o.Oc(" ",t.destination_name," ")}}function Tt(t,e){1&t&&(o.Ub(0,"th",56),o.Mc(1," Warehouse "),o.Tb())}function Ut(t,e){if(1&t&&(o.Ub(0,"td",57),o.Mc(1),o.hc(2,"none"),o.Tb()),2&t){const t=e.$implicit;o.Cb(1),o.Oc(" ",o.ic(2,1,t.warehouse_name)," ")}}function Mt(t,e){1&t&&(o.Ub(0,"th",60),o.Mc(1," Status "),o.Tb())}function vt(t,e){if(1&t&&(o.Ub(0,"td",57),o.Mc(1),o.hc(2,"none"),o.Tb()),2&t){const t=e.$implicit;o.Cb(1),o.Oc(" ",o.ic(2,1,t.shipment_status)," ")}}function yt(t,e){1&t&&(o.Ub(0,"th",60),o.Mc(1," CARGO TYPE "),o.Tb())}function Ot(t,e){if(1&t&&(o.Ub(0,"td",57),o.Mc(1),o.Tb()),2&t){const t=e.$implicit;o.Cb(1),o.Oc(" ",t.container_type," ")}}function Pt(t,e){1&t&&(o.Ub(0,"th",60),o.Mc(1," Container No "),o.Tb())}const wt=function(t){return["/admin/containers/info",t]};function kt(t,e){if(1&t&&(o.Ub(0,"button",63),o.Mc(1),o.hc(2,"none"),o.Tb()),2&t){const t=o.gc().$implicit;o.oc("routerLink",o.sc(4,wt,t.container_id)),o.Cb(1),o.Nc(o.ic(2,2,t.container_no))}}function It(t,e){if(1&t&&(o.Ub(0,"button",64),o.Mc(1),o.hc(2,"none"),o.Tb()),2&t){const t=o.gc().$implicit;o.Cb(1),o.Nc(o.ic(2,1,t.container_no))}}function xt(t,e){if(1&t&&(o.Ub(0,"td",57),o.Kc(1,kt,3,6,"button",61),o.Kc(2,It,3,3,"button",62),o.Tb()),2&t){const t=e.$implicit;o.Cb(1),o.oc("ngIf",t.container_no),o.Cb(1),o.oc("ngIf",!t.container_no)}}function St(t,e){1&t&&(o.Ub(0,"th",60),o.Mc(1," Title "),o.Tb())}function Ft(t,e){if(1&t&&(o.Ub(0,"td",57),o.Mc(1),o.hc(2,"yesno"),o.Tb()),2&t){const t=e.$implicit;o.Cb(1),o.Oc(" ",o.ic(2,1,t.title)," ")}}function Nt(t,e){1&t&&(o.Ub(0,"th",60),o.Mc(1," Key "),o.Tb())}function Dt(t,e){if(1&t&&(o.Ub(0,"td",57),o.Mc(1),o.hc(2,"yesno"),o.Tb()),2&t){const t=e.$implicit;o.Cb(1),o.Oc(" ",o.ic(2,1,t.akey)," ")}}function Kt(t,e){1&t&&(o.Ub(0,"th",60),o.Mc(1," Your Note "),o.Tb())}function Rt(t,e){if(1&t){const t=o.Vb();o.Ub(0,"button",67),o.cc("click",function(){o.Ac(t);const e=o.gc().$implicit;return o.gc().updateNotes(e)}),o.Ub(1,"mat-icon",2),o.Mc(2,"edit"),o.Tb(),o.Tb()}}function At(t,e){if(1&t&&(o.Ub(0,"td",57),o.Ub(1,"div",65),o.Kc(2,Rt,3,0,"button",66),o.Ub(3,"div"),o.Mc(4),o.Tb(),o.Tb(),o.Tb()),2&t){const t=e.$implicit,i=o.gc();o.Cb(2),o.oc("ngIf",i.userId==t.user_id),o.Cb(2),o.Nc(t.note)}}function Vt(t,e){1&t&&(o.Ub(0,"th",60),o.Mc(1," Actions "),o.Tb())}const $t=function(t){return["/admin/shipments/",t]};function Lt(t,e){if(1&t&&(o.Ub(0,"button",72),o.Ub(1,"mat-icon",2),o.Mc(2,"edit"),o.Tb(),o.Ub(3,"span"),o.Mc(4,"Update"),o.Tb(),o.Tb()),2&t){const t=o.gc(2).$implicit;o.oc("routerLink",o.sc(1,$t,t.shipment_id))}}function jt(t,e){if(1&t&&(o.Sb(0),o.Kc(1,Lt,5,3,"button",71),o.Rb()),2&t){const t=o.gc().$implicit,e=o.gc();o.Cb(1),o.oc("ngIf",t.shipment_status_id==e.pending_status_id)}}function Yt(t,e){if(1&t&&(o.Sb(0),o.Ub(1,"button",72),o.Ub(2,"mat-icon",2),o.Mc(3,"edit"),o.Tb(),o.Ub(4,"span"),o.Mc(5,"Update"),o.Tb(),o.Tb(),o.Rb()),2&t){const t=o.gc().$implicit;o.Cb(1),o.oc("routerLink",o.sc(1,$t,t.shipment_id))}}function qt(t,e){if(1&t){const t=o.Vb();o.Ub(0,"button",74),o.cc("click",function(){o.Ac(t);const e=o.gc(2).$implicit;return o.gc().deleteShipment(e.shipment_id)}),o.Ub(1,"mat-icon",2),o.Mc(2,"delete"),o.Tb(),o.Ub(3,"span"),o.Mc(4,"Delete"),o.Tb(),o.Tb()}}function Et(t,e){if(1&t&&(o.Sb(0),o.Kc(1,qt,5,0,"button",73),o.Rb()),2&t){const t=o.gc().$implicit,e=o.gc();o.Cb(1),o.oc("ngIf",t.shipment_status_id==e.pending_status_id)}}function Ht(t,e){if(1&t){const t=o.Vb();o.Sb(0),o.Ub(1,"button",74),o.cc("click",function(){o.Ac(t);const e=o.gc().$implicit;return o.gc().deleteShipment(e.shipment_id)}),o.Ub(2,"mat-icon",2),o.Mc(3,"delete"),o.Tb(),o.Ub(4,"span"),o.Mc(5,"Delete"),o.Tb(),o.Tb(),o.Rb()}}function Gt(t,e){if(1&t){const t=o.Vb();o.Ub(0,"td",57),o.Ub(1,"button",68),o.Ub(2,"mat-icon"),o.Mc(3,"more_vert"),o.Tb(),o.Tb(),o.Ub(4,"mat-menu",null,69),o.Ub(6,"button",70),o.cc("click",function(){o.Ac(t);const i=e.$implicit;return o.gc().openPhoto(i.shipment_id)}),o.Ub(7,"mat-icon"),o.Mc(8,"image"),o.Tb(),o.Ub(9,"span"),o.Mc(10,"Gallery"),o.Tb(),o.Tb(),o.Ub(11,"button",70),o.cc("click",function(){o.Ac(t);const i=e.$implicit;return o.gc().openFiles(i.shipment_id)}),o.Ub(12,"mat-icon"),o.Mc(13,"attach_file"),o.Tb(),o.Ub(14,"span"),o.Mc(15,"Files"),o.Tb(),o.Tb(),o.Kc(16,jt,2,1,"ng-container",11),o.Kc(17,Yt,6,3,"ng-container",11),o.Kc(18,Et,2,1,"ng-container",11),o.Kc(19,Ht,6,0,"ng-container",11),o.Tb(),o.Tb()}if(2&t){const t=o.xc(5),e=o.gc();o.Cb(1),o.oc("matMenuTriggerFor",t),o.Cb(15),o.oc("ngIf",e.pms.update&&e.pms.disable_after_pending),o.Cb(1),o.oc("ngIf",e.pms.update&&!e.pms.disable_after_pending),o.Cb(1),o.oc("ngIf",e.pms.delete&&e.pms.disable_after_pending),o.Cb(1),o.oc("ngIf",e.pms.delete&&!e.pms.disable_after_pending)}}function zt(t,e){1&t&&(o.Ub(0,"th",60),o.Mc(1," View "),o.Tb())}const Bt=function(t){return["/admin/shipments/info",t]};function Wt(t,e){if(1&t&&(o.Ub(0,"td",57),o.Ub(1,"button",75),o.Ub(2,"mat-icon"),o.Mc(3,"remove_red_eye"),o.Tb(),o.Tb(),o.Tb()),2&t){const t=e.$implicit;o.Cb(1),o.oc("routerLink",o.sc(1,Bt,t.shipment_id))}}function Jt(t,e){1&t&&o.Pb(0,"tr",76)}function Qt(t,e){1&t&&o.Pb(0,"tr",77)}function Zt(t,e){1&t&&o.Pb(0,"app-skeleton",78)}function Xt(t,e){if(1&t&&(o.Sb(0),o.Pb(1,"ngx-imageviewer",79),o.Rb()),2&t){const t=o.gc().data;o.Cb(1),o.oc("src",t.src)}}function te(t,e){if(1&t&&o.Kc(0,Xt,2,1,"ng-container",11),2&t){const t=e.index,i=e.currIndex;o.oc("ngIf","imageViewer"===e.type&&t===i)}}const ee=function(){return[10,20,30,100]};let ie=(()=>{class t{constructor(t,e,i,n,a,o,b,l){if(this.exportAsService=t,this.router=e,this.dialog=i,this.shipmentService=n,this._manager=a,this.auth=o,this.gallery=b,this.lightbox=l,this.exportAsConfig={type:"pdf",elementIdOrContent:"content"},this.lightboxRef=null,this.warehouses_list=[],this.shippment_statuses=[],this.shipmentStatusId=new r.g(""),this.warehouseId=new r.g(""),this.shipmentVehicle=new r.g(""),this.shipmentVehicleValue=new r.g(""),this.shipperName=new r.g,this.dateCtrl=new r.g,this.descriptionCtrl=new r.g,this.receiverName=new r.g,this.destinationName=new r.g,this.trackingId=new r.g,this.isLoadingResults=!0,this.isRateLimitReached=!1,this.resultsLength=0,this.pageSize=20,this.searchTerms={shipper_name:"",date:"",receiver_name:"",description:"",shipment_status_id:"",warehouse_id:"",package_type:"",package_value:"",destination_name:"",shipment_id:""},this.loaded=!1,this.pms={},this.userId=0,this.pending_status_id=0,this.displayedColumns=["shipment_id","receiver_name","destination_name","container_no","title","akey","status","container_type","files","image","view","update","delete"],this.dataSource=new c.o,this.selection=new s.c(!0,[]),this.pending_status_id=this.auth.currentUserValue.pending_status_id,o.currentUserValue.permission){this.userId=o.currentUserValue.user_id,this.pms=o.currentUserValue.permission.shipment;let t=["shipment_id"];this.pms.view_shipper&&t.push("shipper_name"),t.push("receiver_name","description","date","destination_name","warehouse_name","container_no"),t.push("title","akey","status","container_type","note"),this.pms.view&&t.push("view"),t.push("actions"),this.displayedColumns=t}}resetFilter(){this.searchTerms={shipper_name:"",date:"",receiver_name:"",description:"",shipment_status_id:"",warehouse_id:"",destination_name:"",package_type:"",package_value:"",shipment_id:""},this.warehouseId.setValue(""),this.shipmentStatusId.setValue(""),this.warehouseId.setValue(""),this.shipmentVehicle.setValue(""),this.shipmentVehicleValue.setValue(""),this.shipperName.setValue(""),this.descriptionCtrl.setValue(""),this.dateCtrl.setValue(""),this.receiverName.setValue(""),this.destinationName.setValue(""),this.trackingId.setValue(""),this.paginator.pageIndex=0,this.callSubject.next()}deleteShipment(t){this.dialog.open(d.a,{data:{title:"Are you sure?",id:t}}).afterClosed().subscribe(t=>{if(t){const e=new FormData;e.append("shipment_id",t),this.shipmentService.deleteShipment(e).subscribe(e=>{this.dataSource.data=this.dataSource.data.filter(e=>e.shipment_id!=t)})}})}ngOnInit(){this.callSubject=new u.a,this.callSubject.pipe(Object(_.a)(()=>{this.isLoadingResults=!0}),Object(C.a)(500)).subscribe(()=>{this.activeNavigation()}),this.trackingId.valueChanges.subscribe(t=>{this.searchTerms.shipment_id=t,this.applyFilter(t)}),this.shipperName.valueChanges.subscribe(t=>{this.searchTerms.shipper_name=t,this.applyFilter(t)}),this.dateCtrl.valueChanges.subscribe(t=>{this.searchTerms.date=t?b(new Date(t)).format("YYYY-MM-DD"):"",this.applyFilter(this.searchTerms.date)}),this.descriptionCtrl.valueChanges.subscribe(t=>{this.searchTerms.description=t,this.applyFilter(this.searchTerms.description)}),this.receiverName.valueChanges.subscribe(t=>{this.searchTerms.receiver_name=t,this.applyFilter(t)}),this.destinationName.valueChanges.subscribe(t=>{this.searchTerms.destination_name=t,this.applyFilter(t)}),this.warehouseId.valueChanges.subscribe(t=>{this.searchTerms.warehouse_id=t,this.applyFilter(t)}),this.shipmentStatusId.valueChanges.subscribe(t=>{this.searchTerms.shipment_status_id=t,this.applyFilter(t)}),this.shipmentVehicle.valueChanges.subscribe(t=>{this.searchTerms.package_type=t,this.applyFilter(t)}),this.shipmentVehicleValue.valueChanges.subscribe(t=>{this.searchTerms.package_value=t,this.applyFilter(t)}),this.dataSource.filterPredicate=(t,e)=>{let i=!0;if(this.searchTerms.package_type)if("0"==this.searchTerms.package_type)i=!0;else for(let n=0;n<t.packages.length;n++)i=!!t.packages[n][this.searchTerms.package_type]&&-1!==t.packages[n][this.searchTerms.package_type].toString().toLowerCase().indexOf(this.searchTerms.package_value);return t.shipper_name&&-1!==t.shipper_name.toLowerCase().indexOf(this.searchTerms.shipper_name)&&-1!==t.shipment_id.toString().toLowerCase().indexOf(this.searchTerms.shipment_id)&&-1!==t.warehouse_id.toString().toLowerCase().indexOf(this.searchTerms.warehouse_id)&&t.receiver_name&&-1!==t.receiver_name.toString().toLowerCase().indexOf(this.searchTerms.receiver_name)&&-1!==t.shipment_status_id.toString().toLowerCase().indexOf(this.searchTerms.shipment_status_id)&&t.destination_name&&-1!==t.destination_name.toLowerCase().indexOf(this.searchTerms.destination_name)&&i},this.lightboxRef=this.gallery.ref("lightbox"),this.lightboxRef.setConfig({imageSize:m.e.Contain,thumbPosition:m.f.Top,itemTemplate:this.itemTemplate,gestures:!1})}ngAfterViewInit(){this.activeNavigation()}activeNavigation(){Object(g.a)(this.sort.sortChange,this.paginator.page).pipe(Object(T.a)({}),Object(U.a)(()=>(this.isLoadingResults=!0,this.shipmentService.getShipments({sort:this.sort.active,order:this.sort.direction,pagesize:this.paginator.pageSize,page:this.paginator.pageIndex+1,filter:Object.keys(this.searchTerms).map(t=>t+"___"+this.searchTerms[t]).join("|")}))),Object(M.a)(t=>(this.isLoadingResults=!1,this.isRateLimitReached=!1,this.resultsLength=t.total,t.items)),Object(v.a)(()=>(this.isLoadingResults=!1,this.isRateLimitReached=!0,Object(f.a)([])))).subscribe(t=>{this.dataSource.data=t,this.loaded||this._manager.getShipmentStatuses().subscribe(t=>{t&&(this.shippment_statuses=t.data),this._manager.getWarehouses().subscribe(t=>{t&&(this.warehouses_list=t.data),this.loaded=!0,setTimeout(()=>{this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0)},0)})})})}applyFilter(t){let e=t.toString();this.paginator.pageIndex=0,e=e.trim(),e=e.toLowerCase(),this.callSubject.next()}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.data.forEach(t=>this.selection.select(t))}checkboxLabel(t){return t?`${this.selection.isSelected(t)?"deselect":"select"} row ${t.shipment_id}`:(this.isAllSelected()?"select":"deselect")+" all"}openPhoto(t){let e=new FormData;e.append("shipment_id",t),this.shipmentService.getShipmentHistory(e).subscribe(t=>{if(t){let e=[];for(let i=0;i<t.data.length;i++){let n=t.data[i].file;if(n&&n.length>0)for(let t=0;t<n.length;t++)e.push(n[t])}e.length>0&&(this.gallery_items=e.map(t=>new m.d({src:t,thumb:t})),this.lightboxRef.load(this.gallery_items),this.lightbox.open(0,"lightbox",{panelClass:"fullscreen"}))}})}updateNotes(t){this.dialog.open(F,{data:{item:t}}).afterClosed().subscribe(t=>{console.log(t)})}openFiles(t){this.dialog.open(l.a,{data:{shipment_id:t}}).afterClosed().subscribe(t=>{})}savePDF(){document.body.classList.add("print_mode"),this.exportAsService.save(this.exportAsConfig,"shipments").subscribe(()=>{setTimeout(()=>{document.body.classList.remove("print_mode")},1e3)})}printPage(){window.print()}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(N.b),o.Ob(a.e),o.Ob(y.b),o.Ob(P.a),o.Ob(D.a),o.Ob(K.a),o.Ob(m.a),o.Ob(R.a))},t.\u0275cmp=o.Ib({type:t,selectors:[["app-shipments"]],viewQuery:function(t,e){var i;1&t&&(o.Rc(p.a,!0),o.Rc(h.a,!0),o.Rc(B,!0),o.Rc(W,!0,o.l)),2&t&&(o.wc(i=o.dc())&&(e.sort=i.first),o.wc(i=o.dc())&&(e.paginator=i.first),o.wc(i=o.dc())&&(e.itemTemplate=i.first),o.wc(i=o.dc())&&(e.content=i.first))},decls:112,vars:22,consts:[["packageItem",""],[1,"cs-page-header"],["mat-list-icon",""],[1,"cs-right"],["mat-flat-button","",3,"routerLink",4,"ngIf"],["mat-flat-button","",3,"click"],[0,"xlink","href","#print_ico"],[0,"xlink","href","#pdf_ico"],[1,"cs-box"],[1,"form-filter"],["type","text","matInput","",3,"formControl"],[4,"ngIf"],[3,"formControl"],["value",""],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","Date",3,"matDatepicker","formControl"],["matSuffix","",3,"for"],["pickpicker",""],["type","text","matInput","","autocomplete","off",3,"formControl"],[1,"filter-btn"],["mat-raised-button","","color","warn",3,"click"],[1,"mat-elevation-z8"],[4,"ngIf","ngIfElse"],["class","loading-shade",4,"ngIf"],["mat-table","","matSort","","matSortDisableClear","","matSortActive","shipment_id","matSortDirection","desc","id","content",3,"hidden","dataSource"],["content",""],["matColumnDef","shipment_id"],["mat-header-cell","","mat-sort-header","","disableClear","",4,"matHeaderCellDef"],["mat-cell","",3,"click",4,"matCellDef"],["matColumnDef","description"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","date"],["matColumnDef","shipper_name"],["matColumnDef","receiver_name"],["matColumnDef","destination_name","disableClear",""],["matColumnDef","warehouse_name","disableClear",""],["matColumnDef","status"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","container_type"],["matColumnDef","container_no"],["matColumnDef","title"],["matColumnDef","akey"],["matColumnDef","note"],["matColumnDef","actions"],["matColumnDef","view"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions","length"],["rowsPlaceHolder",""],["itemTemplate",""],["mat-flat-button","",3,"routerLink"],[3,"value"],[1,"loading-shade"],["mat-header-cell","","mat-sort-header","","disableClear",""],["mat-cell","",3,"click"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[4,"ngFor","ngForOf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["mat-header-cell",""],["mat-button","","color","primary",3,"routerLink",4,"ngIf"],["mat-button","","color","primary",4,"ngIf"],["mat-button","","color","primary",3,"routerLink"],["mat-button","","color","primary"],[1,"txtibtn"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"click"],["mat-icon-button","","aria-label","Actions",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","","color","warn",3,"click"],["mat-menu-item","","aria-label","Edit",3,"routerLink",4,"ngIf"],["mat-menu-item","","aria-label","Edit",3,"routerLink"],["mat-menu-item","","aria-label","Edit",3,"click",4,"ngIf"],["mat-menu-item","","aria-label","Edit",3,"click"],["mat-icon-button","","color","warn",3,"routerLink"],["mat-header-row",""],["mat-row",""],["type","rows"],[3,"src"]],template:function(t,e){if(1&t&&(o.Kc(0,Z,2,2,"ng-template",null,0,o.Lc),o.Ub(2,"div",1),o.Ub(3,"span"),o.Ub(4,"mat-icon",2),o.Mc(5,"stars"),o.Tb(),o.Mc(6," Shipments"),o.Tb(),o.Ub(7,"div",3),o.Kc(8,X,4,1,"a",4),o.Ub(9,"button",5),o.cc("click",function(){return e.printPage()}),o.fc(),o.Ub(10,"svg"),o.Pb(11,"use",6),o.Tb(),o.Tb(),o.ec(),o.Ub(12,"button",5),o.cc("click",function(){return e.savePDF()}),o.fc(),o.Ub(13,"svg"),o.Pb(14,"use",7),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.ec(),o.Ub(15,"div",8),o.Ub(16,"div",9),o.Ub(17,"form"),o.Ub(18,"mat-form-field"),o.Ub(19,"mat-label"),o.Mc(20,"ID"),o.Tb(),o.Pb(21,"input",10),o.Tb(),o.Kc(22,tt,4,1,"mat-form-field",11),o.Ub(23,"mat-form-field"),o.Ub(24,"mat-label"),o.Mc(25,"Status"),o.Tb(),o.Ub(26,"mat-select",12),o.Ub(27,"mat-option",13),o.Mc(28,"All Statuses"),o.Tb(),o.Kc(29,et,2,2,"mat-option",14),o.Tb(),o.Tb(),o.Ub(30,"mat-form-field"),o.Ub(31,"mat-label"),o.Mc(32,"Warehouse"),o.Tb(),o.Ub(33,"mat-select",12),o.Ub(34,"mat-option",13),o.Mc(35,"All Warehouses"),o.Tb(),o.Kc(36,it,2,2,"mat-option",14),o.Tb(),o.Tb(),o.Ub(37,"mat-form-field"),o.Ub(38,"mat-label"),o.Mc(39,"Destination"),o.Tb(),o.Pb(40,"input",10),o.Tb(),o.Ub(41,"mat-form-field"),o.Ub(42,"mat-label"),o.Mc(43,"Date"),o.Tb(),o.Pb(44,"input",15),o.Pb(45,"mat-datepicker-toggle",16),o.Pb(46,"mat-datepicker",null,17),o.Tb(),o.Ub(48,"mat-form-field"),o.Ub(49,"mat-label"),o.Mc(50,"Description"),o.Tb(),o.Pb(51,"input",18),o.Tb(),o.Ub(52,"div",19),o.Ub(53,"button",20),o.cc("click",function(){return e.resetFilter()}),o.Mc(54,"Reset"),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Ub(55,"div",21),o.Kc(56,nt,1,0,"div",22),o.Kc(57,ot,2,1,"div",23),o.Ub(58,"table",24,25),o.Sb(60,26),o.Kc(61,ct,2,0,"th",27),o.Kc(62,st,3,3,"td",28),o.Rb(),o.Sb(63,29),o.Kc(64,rt,2,0,"th",30),o.Kc(65,dt,3,1,"td",31),o.Rb(),o.Sb(66,32),o.Kc(67,mt,2,0,"th",27),o.Kc(68,pt,3,3,"td",31),o.Rb(),o.Sb(69,33),o.Kc(70,ht,2,0,"th",27),o.Kc(71,ut,2,1,"td",31),o.Rb(),o.Sb(72,34),o.Kc(73,gt,2,0,"th",27),o.Kc(74,ft,2,1,"td",31),o.Rb(),o.Sb(75,35),o.Kc(76,_t,2,0,"th",30),o.Kc(77,Ct,2,1,"td",31),o.Rb(),o.Sb(78,36),o.Kc(79,Tt,2,0,"th",30),o.Kc(80,Ut,3,3,"td",31),o.Rb(),o.Sb(81,37),o.Kc(82,Mt,2,0,"th",38),o.Kc(83,vt,3,3,"td",31),o.Rb(),o.Sb(84,39),o.Kc(85,yt,2,0,"th",38),o.Kc(86,Ot,2,1,"td",31),o.Rb(),o.Sb(87,40),o.Kc(88,Pt,2,0,"th",38),o.Kc(89,xt,3,2,"td",31),o.Rb(),o.Sb(90,41),o.Kc(91,St,2,0,"th",38),o.Kc(92,Ft,3,3,"td",31),o.Rb(),o.Sb(93,42),o.Kc(94,Nt,2,0,"th",38),o.Kc(95,Dt,3,3,"td",31),o.Rb(),o.Sb(96,43),o.Kc(97,Kt,2,0,"th",38),o.Kc(98,At,5,2,"td",31),o.Rb(),o.Sb(99,44),o.Kc(100,Vt,2,0,"th",38),o.Kc(101,Gt,20,5,"td",31),o.Rb(),o.Sb(102,45),o.Kc(103,zt,2,0,"th",38),o.Kc(104,Wt,4,3,"td",31),o.Rb(),o.Kc(105,Jt,1,0,"tr",46),o.Kc(106,Qt,1,0,"tr",47),o.Tb(),o.Pb(107,"mat-paginator",48),o.Tb(),o.Tb(),o.Kc(108,Zt,1,0,"ng-template",null,49,o.Lc),o.Kc(110,te,1,1,"ng-template",null,50,o.Lc)),2&t){const t=o.xc(47),i=o.xc(109);o.Cb(8),o.oc("ngIf",e.pms.add),o.Cb(13),o.oc("formControl",e.trackingId),o.Cb(1),o.oc("ngIf",e.pms.view_shipper),o.Cb(4),o.oc("formControl",e.shipmentStatusId),o.Cb(3),o.oc("ngForOf",e.shippment_statuses),o.Cb(4),o.oc("formControl",e.warehouseId),o.Cb(3),o.oc("ngForOf",e.warehouses_list),o.Cb(4),o.oc("formControl",e.destinationName),o.Cb(4),o.oc("matDatepicker",t)("formControl",e.dateCtrl),o.Cb(1),o.oc("for",t),o.Cb(6),o.oc("formControl",e.descriptionCtrl),o.Cb(5),o.oc("ngIf",e.loaded)("ngIfElse",i),o.Cb(1),o.oc("ngIf",e.loaded&&(e.isLoadingResults||e.isRateLimitReached)),o.Cb(1),o.oc("hidden",!e.loaded)("dataSource",e.dataSource),o.Cb(47),o.oc("matHeaderRowDef",e.displayedColumns),o.Cb(1),o.oc("matRowDefColumns",e.displayedColumns),o.Cb(1),o.oc("pageSizeOptions",o.rc(21,ee))("length",e.resultsLength)}},directives:[w.a,k.b,n.l,S.b,r.w,r.r,r.s,I.b,I.e,x.b,r.d,r.q,r.h,A.a,V.o,n.k,$.b,$.d,I.g,$.a,c.n,p.a,c.c,c.i,c.b,c.k,c.m,h.a,S.a,a.h,L.c,c.h,p.b,c.a,n.q,a.f,j.c,j.d,j.a,c.j,c.l,Y.a,q.b],pipes:[E,H,G.a,z.a],styles:["table[_ngcontent-%COMP%]{width:100%}.mat-elevation-z8[_ngcontent-%COMP%]{width:100%;overflow:auto}.mat-column-select[_ngcontent-%COMP%]{width:66px}.mat-column-container_type[_ngcontent-%COMP%]{text-align:center}.mat-column-delete[_ngcontent-%COMP%], .mat-column-print[_ngcontent-%COMP%], .mat-column-update[_ngcontent-%COMP%], .mat-column-view[_ngcontent-%COMP%]{width:56px;text-align:center!important}.mat-column-note[_ngcontent-%COMP%]{width:160px}.mat-column-delete[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#ea4141}.mat-column-update[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#2ba7ff}.mat-column-print[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#68c362}.mat-column-view[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#d0b142}th.mat-header-cell[_ngcontent-%COMP%]{font-weight:700;color:#000}mat-card[_ngcontent-%COMP%]{display:flex;flex-direction:column}mat-grid-tile[_ngcontent-%COMP%]     .mat-figure{align-items:start}mat-form-field[_ngcontent-%COMP%]{padding:0 0 20px;margin-right:20px}mat-form-field[_ngcontent-%COMP%]     .mat-form-field-infix{padding:13px 0}.filter-btn[_ngcontent-%COMP%]{display:inline-block;width:110px}.filter-btn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}tr.sp-detail-row[_ngcontent-%COMP%]{height:0}tr.sp-detail-row[_ngcontent-%COMP%]:not(.sp-expanded-row), tr.sp-detail-row[_ngcontent-%COMP%]:not(.sp-expanded-row):hover{background:#f5f5f5}tr.sp-detail-row[_ngcontent-%COMP%]:not(.sp-expanded-row):active{background:#efefef}tr.sp-detail-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:0 7px}.sp-element-row[_ngcontent-%COMP%]{position:relative}.sp-element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}.sp-element-row.sp-expanded-row[_ngcontent-%COMP%]   .mat-cell.cdk-column-tracking_id[_ngcontent-%COMP%]:after{transform:rotate(45deg);top:20px}.sp-element-detail[_ngcontent-%COMP%]{overflow:hidden;display:block}.txtibtn[_ngcontent-%COMP%]{position:relative}.txtibtn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:absolute;top:0;right:0;padding:0;width:auto;min-width:auto;height:auto;border:1px solid #e4e4e4;min-height:auto;line-height:1}.sp-element-diagram[_ngcontent-%COMP%]{min-width:80px;font-weight:lighter;margin:8px 0}.mat-column-container_no[_ngcontent-%COMP%], .mat-column-destination_name[_ngcontent-%COMP%], .mat-column-warehouse_name[_ngcontent-%COMP%]{width:55px}.mat-column-container_no[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .mat-column-destination_name[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .mat-column-warehouse_name[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:13px;padding:0;width:100%;white-space:normal;line-height:1.5}.pck1[_ngcontent-%COMP%], .pck2[_ngcontent-%COMP%]{display:table;width:100%;background:#f9f9f9;border:1px solid #ececec;border-radius:5px}.pck1[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;width:20%;padding:10px 7px;border-right:1px solid #ececec;height:100%;position:relative;word-break:break-all}.pck1[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{border-right:none}.pck1[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%], .pck2[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%]{margin:0;font-size:16px}.pck1[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h4[_ngcontent-%COMP%], .pck2[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h4[_ngcontent-%COMP%]{margin:0}.pck2[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;width:80%;padding:10px 7px;border-right:1px solid #ececec;height:100%;position:relative;word-break:break-all}.pck2[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{border-right:none}.pck2[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-of-type(2){width:19%}@media screen and (max-width:900px){.pck1[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .pck2[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;width:100%;margin-bottom:10px}.pck2[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-of-type(2){width:100%}.sp-element-diagram[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:20px}.sp-element-diagram[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{margin-bottom:0}}"]}),t})();var ne=i("enEE"),ae=i("IheW"),oe=i("DejY"),ce=i("yZJs"),se=i("AytR");function re(t,e){1&t&&o.Pb(0,"mat-spinner",4)}function be(t,e){if(1&t){const t=o.Vb();o.Ub(0,"div"),o.Pb(1,"img",5),o.Ub(2,"div",6),o.Ub(3,"div",7),o.Ub(4,"label",8),o.Ub(5,"mat-icon",9),o.Mc(6,"edit"),o.Tb(),o.Tb(),o.Ub(7,"input",10),o.cc("change",function(i){o.Ac(t);const n=e.index,a=e.$implicit;return o.gc().onFileChange(i,n,a)}),o.Tb(),o.Tb(),o.Ub(8,"button",11),o.cc("click",function(){o.Ac(t);const i=e.$implicit;return o.gc().deleteItem(i)}),o.Ub(9,"mat-icon",9),o.Mc(10,"delete"),o.Tb(),o.Tb(),o.Tb(),o.Tb()}if(2&t){const t=e.$implicit,i=e.index;o.Cb(1),o.oc("src",t,o.Dc),o.Cb(3),o.qc("for","myimage",i,""),o.Cb(3),o.qc("id","myimage",i,"")}}let le=(()=>{class t{constructor(t,e,i){this.dialogRef=t,this.data=e,this._shipmentService=i,this.percentCompleted=0,this.isUploaded=!1,this.submitted=!1}ngOnInit(){console.log(this.data.item)}onFileChange(t,e,i){this.submitted=!0;let n=new FormData;n.append("file",t.target.files[0]),n.append("history_id",this.data.item.history_id),n.append("url",i),this._shipmentService.updateHistoryItem(n).subscribe(t=>{t.type===ae.d.UploadProgress?this.percentCompleted=Math.round(100*t.loaded/t.total):t instanceof ae.e&&(this.isUploaded=!0,this.submitted=!1,t.body.history_item&&(this.data.item.file[e]=t.body.history_item))},t=>{this.submitted=!1})}deleteItem(t){let e=new FormData;e.append("history_id",this.data.item.history_id),e.append("url",t),this._shipmentService.deleteHistoryItem(e).subscribe(e=>{this.data.item.file=this.data.item.file.filter(e=>e!==t)},t=>{this.submitted=!1})}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(y.g),o.Ob(y.a),o.Ob(P.a))},t.\u0275cmp=o.Ib({type:t,selectors:[["app-filemanager"]],decls:6,vars:2,consts:[[1,"container"],["diameter","28",4,"ngIf"],[1,"list"],[4,"ngFor","ngForOf"],["diameter","28"],[3,"src"],[1,"actions"],[1,"btn"],[3,"for"],["mat-list-icon",""],["type","file","accept",".png, .jpg, .jpeg",2,"display","none",3,"id","change"],["mat-button","",3,"click"]],template:function(t,e){1&t&&(o.Ub(0,"div",0),o.Ub(1,"h1"),o.Mc(2,"File Manager "),o.Kc(3,re,1,0,"mat-spinner",1),o.Tb(),o.Ub(4,"div",2),o.Kc(5,be,11,3,"div",3),o.Tb(),o.Tb()),2&t&&(o.Cb(3),o.oc("ngIf",e.submitted),o.Cb(2),o.oc("ngForOf",e.data.item.file))},directives:[n.l,n.k,L.c,w.a,k.b,S.b],styles:[".container[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{display:block}.container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100px;height:100px;background:#e6e6e6;position:relative;margin-right:5px;margin-bottom:5px;float:left}.container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-of-type(5n+1){clear:both}.container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{position:absolute;display:inline-block;top:2px;right:2px}.container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline-block;font-size:10px;padding:2px;min-width:auto;line-height:1;background:#fff;margin:2px;width:25px;height:25px}.container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:15px;height:15px;font-size:19px;vertical-align:inherit}mat-spinner[_ngcontent-%COMP%]{vertical-align:middle}.btn[_ngcontent-%COMP%], mat-spinner[_ngcontent-%COMP%]{display:inline-block}.btn[_ngcontent-%COMP%]{background:#fff;border-radius:4px;padding:3px;line-height:1;vertical-align:top;width:25px;height:25px;margin:2px}.btn[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer}.btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:15px;height:15px;font-size:19px}"]}),t})();var de=i("2DQX"),me=i("sORc"),pe=i("PDjf"),he=i("jMqV"),ue=i("vrAh");const ge=["itemTemplate"];function fe(t,e){1&t&&(o.Ub(0,"span"),o.Ub(1,"mat-icon",4),o.Mc(2,"add"),o.Tb(),o.Mc(3," Create Shipment"),o.Tb())}function _e(t,e){1&t&&(o.Ub(0,"span"),o.Ub(1,"mat-icon",4),o.Mc(2,"edit"),o.Tb(),o.Mc(3," Edit Shipment"),o.Tb())}function Ce(t,e){if(1&t&&(o.Ub(0,"div",51),o.Mc(1),o.hc(2,"zeroid"),o.Tb()),2&t){const t=o.gc();o.Cb(1),o.Oc(" Tracking ID ",o.ic(2,1,t.shipmentId)," ")}}const Te=function(t){return{"is-invalid":t}};function Ue(t,e){if(1&t&&(o.Sb(0),o.Pb(1,"input",52),o.Rb()),2&t){const t=o.gc();o.Cb(1),o.oc("ngClass",o.sc(1,Te,(t.shipperForm.name.touched||t.submitted)&&(null==t.shipperForm.name.errors?null:t.shipperForm.name.errors.required)))}}function Me(t,e){if(1&t&&(o.Ub(0,"mat-option",33),o.Mc(1),o.Tb()),2&t){const t=e.$implicit;o.oc("value",t),o.Cb(1),o.Oc(" ",t.name," ")}}function ve(t,e){if(1&t){const t=o.Vb();o.Sb(0),o.Pb(1,"input",53),o.Ub(2,"mat-autocomplete",54,55),o.cc("optionSelected",function(e){return o.Ac(t),o.gc().onShipperSelectionChanged(e)}),o.Kc(4,Me,2,2,"mat-option",13),o.hc(5,"async"),o.Tb(),o.Rb()}if(2&t){const t=o.xc(3),e=o.gc();o.Cb(1),o.oc("matAutocomplete",t),o.Cb(1),o.oc("displayWith",e.displayShipper()),o.Cb(2),o.oc("ngForOf",o.ic(5,3,e.filteredShippers))}}function ye(t,e){if(1&t&&(o.Ub(0,"mat-option",33),o.Mc(1),o.Tb()),2&t){const t=e.$implicit;o.oc("value",t.id),o.Cb(1),o.Oc(" ",t.name," ")}}function Oe(t,e){1&t&&(o.Sb(0),o.Pb(1,"input",56),o.Rb())}function Pe(t,e){if(1&t&&(o.Ub(0,"mat-option",33),o.Mc(1),o.Tb()),2&t){const t=e.$implicit;o.oc("value",t),o.Cb(1),o.Oc(" ",t.name," ")}}function we(t,e){if(1&t){const t=o.Vb();o.Sb(0),o.Pb(1,"input",53),o.Ub(2,"mat-autocomplete",54,57),o.cc("optionSelected",function(e){return o.Ac(t),o.gc().onReceiverSelectionChanged(e)}),o.Kc(4,Pe,2,2,"mat-option",13),o.hc(5,"async"),o.Tb(),o.Rb()}if(2&t){const t=o.xc(3),e=o.gc();o.Cb(1),o.oc("matAutocomplete",t),o.Cb(1),o.oc("displayWith",e.displayReceiver()),o.Cb(2),o.oc("ngForOf",o.ic(5,3,e.filteredReceivers))}}function ke(t,e){if(1&t){const t=o.Vb();o.Sb(0),o.Ub(1,"mat-form-field"),o.Ub(2,"mat-label"),o.Mc(3,"Year"),o.Tb(),o.Pb(4,"input",59),o.Tb(),o.Ub(5,"mat-form-field"),o.Ub(6,"mat-label"),o.Mc(7,"Model"),o.Tb(),o.Pb(8,"input",60),o.Tb(),o.Ub(9,"mat-form-field"),o.Ub(10,"mat-label"),o.Mc(11,"Make"),o.Tb(),o.Pb(12,"input",61),o.Tb(),o.Ub(13,"mat-form-field"),o.Ub(14,"mat-label"),o.Mc(15,"Vin"),o.Tb(),o.Pb(16,"input",62),o.Tb(),o.Ub(17,"mat-form-field"),o.Ub(18,"mat-label"),o.Mc(19,"Value"),o.Tb(),o.Pb(20,"input",63),o.Ub(21,"span",64),o.Mc(22,"$\xa0"),o.Tb(),o.Tb(),o.Ub(23,"div",65),o.Ub(24,"button",66),o.cc("click",function(){o.Ac(t);const e=o.gc().index;return o.gc().deletePackage(e)}),o.Mc(25,"Delete"),o.Tb(),o.Tb(),o.Rb()}}function Ie(t,e){if(1&t){const t=o.Vb();o.Sb(0),o.Ub(1,"mat-form-field",67),o.Ub(2,"mat-label"),o.Mc(3,"Description"),o.Tb(),o.Pb(4,"input",68),o.Tb(),o.Ub(5,"mat-form-field"),o.Ub(6,"mat-label"),o.Mc(7,"Value"),o.Tb(),o.Pb(8,"input",63),o.Ub(9,"span",64),o.Mc(10,"$\xa0"),o.Tb(),o.Tb(),o.Ub(11,"div",65),o.Ub(12,"button",66),o.cc("click",function(){o.Ac(t);const e=o.gc().index;return o.gc().deletePackage(e)}),o.Mc(13,"Delete"),o.Tb(),o.Tb(),o.Rb()}}function xe(t,e){if(1&t&&(o.Ub(0,"div",58),o.Kc(1,ke,26,0,"ng-container",1),o.Kc(2,Ie,14,0,"ng-container",1),o.Tb()),2&t){const t=e.$implicit;o.oc("formGroupName",e.index),o.Cb(1),o.oc("ngIf",1==t.value.type),o.Cb(1),o.oc("ngIf",2==t.value.type)}}function Se(t,e){1&t&&(o.Ub(0,"th"),o.Mc(1,"Added By"),o.Tb())}function Fe(t,e){1&t&&(o.Ub(0,"button",76),o.Ub(1,"mat-icon"),o.Mc(2,"image"),o.Tb(),o.Tb())}function Ne(t,e){if(1&t){const t=o.Vb();o.Ub(0,"button",77),o.cc("click",function(){o.Ac(t);const e=o.gc().$implicit;return o.gc(2).openGallery(e)}),o.Ub(1,"mat-icon"),o.Mc(2,"image"),o.Tb(),o.Tb()}}function De(t,e){if(1&t&&(o.Ub(0,"td"),o.Mc(1),o.Tb()),2&t){const t=o.gc().$implicit;o.Cb(1),o.Nc(t.username)}}function Ke(t,e){if(1&t){const t=o.Vb();o.Ub(0,"button",77),o.cc("click",function(){o.Ac(t);const e=o.gc().$implicit;return o.gc(2).openEditFiles(e)}),o.Ub(1,"mat-icon"),o.Mc(2,"edit"),o.Tb(),o.Tb()}}function Re(t,e){if(1&t){const t=o.Vb();o.Ub(0,"button",77),o.cc("click",function(){o.Ac(t);const e=o.gc().$implicit;return o.gc(2).downloadGallery(e)}),o.Ub(1,"mat-icon"),o.Mc(2,"cloud_download"),o.Tb(),o.Tb()}}function Ae(t,e){if(1&t&&(o.Ub(0,"tr"),o.Ub(1,"td"),o.Mc(2),o.Tb(),o.Ub(3,"td"),o.Kc(4,Fe,3,0,"button",74),o.Kc(5,Ne,3,0,"button",75),o.Tb(),o.Kc(6,De,2,1,"td",1),o.Ub(7,"td"),o.Mc(8),o.Tb(),o.Ub(9,"td"),o.Mc(10),o.Tb(),o.Ub(11,"td"),o.Kc(12,Ke,3,0,"button",75),o.Kc(13,Re,3,0,"button",75),o.Tb(),o.Tb()),2&t){const t=e.$implicit,i=o.gc(2);o.Cb(2),o.Nc(t.name),o.Cb(2),o.oc("ngIf",!t.file),o.Cb(1),o.oc("ngIf",t.file),o.Cb(1),o.oc("ngIf",i.permission.show_user_column),o.Cb(2),o.Nc(t.note),o.Cb(2),o.Nc(t.date_added),o.Cb(2),o.oc("ngIf",i.permission.control_history_gallery&&t.file),o.Cb(1),o.oc("ngIf",t.file)}}function Ve(t,e){if(1&t){const t=o.Vb();o.Ub(0,"div",69),o.Ub(1,"mat-card",10),o.Ub(2,"mat-card-header"),o.Ub(3,"mat-card-title"),o.Mc(4,"Shipment History"),o.Tb(),o.Ub(5,"button",70),o.cc("click",function(){return o.Ac(t),o.gc().downloadShipmentGallery()}),o.Ub(6,"mat-icon"),o.Mc(7,"cloud_download"),o.Tb(),o.Tb(),o.Tb(),o.Ub(8,"mat-card-content"),o.Ub(9,"div"),o.Ub(10,"div",71),o.Ub(11,"table",72),o.Ub(12,"thead"),o.Ub(13,"th"),o.Mc(14,"Shipment Status"),o.Tb(),o.Ub(15,"th"),o.Mc(16,"Image"),o.Tb(),o.Kc(17,Se,2,0,"th",1),o.Ub(18,"th"),o.Mc(19,"Note"),o.Tb(),o.Ub(20,"th"),o.Mc(21,"Added Date"),o.Tb(),o.Ub(22,"th"),o.Mc(23,"Actions"),o.Tb(),o.Tb(),o.Ub(24,"tbody"),o.Kc(25,Ae,14,8,"tr",73),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb()}if(2&t){const t=o.gc();o.Cb(17),o.oc("ngIf",t.permission.show_user_column),o.Cb(8),o.oc("ngForOf",t.shipmentHistory)}}function $e(t,e){if(1&t&&(o.Ub(0,"mat-option",33),o.Mc(1),o.Tb()),2&t){const t=e.$implicit;o.oc("value",t.id),o.Cb(1),o.Oc(" ",t.name," ")}}function Le(t,e){1&t&&(o.Sb(0),o.Pb(1,"input",78),o.Rb())}function je(t,e){if(1&t&&(o.Ub(0,"mat-option",33),o.Mc(1),o.Tb()),2&t){const t=e.$implicit;o.oc("value",t),o.Cb(1),o.Oc(" ",t.name," ")}}function Ye(t,e){if(1&t){const t=o.Vb();o.Sb(0),o.Pb(1,"input",79),o.Ub(2,"mat-autocomplete",54,80),o.cc("optionSelected",function(e){return o.Ac(t),o.gc().onDestinationSelectionChanged(e)}),o.Kc(4,je,2,2,"mat-option",13),o.hc(5,"async"),o.Tb(),o.Rb()}if(2&t){const t=o.xc(3),e=o.gc();o.Cb(1),o.oc("matAutocomplete",t),o.Cb(1),o.oc("displayWith",e.displayDestination()),o.Cb(2),o.oc("ngForOf",o.ic(5,3,e.filteredDestinations))}}function qe(t,e){if(1&t&&(o.Ub(0,"mat-option",33),o.Mc(1),o.Tb()),2&t){const t=e.$implicit;o.oc("value",t.id),o.Cb(1),o.Oc(" ",t.name," ")}}function Ee(t,e){if(1&t&&(o.Ub(0,"mat-option",33),o.Mc(1),o.Tb()),2&t){const t=e.$implicit;o.oc("value",t),o.Cb(1),o.Pc(" ",t.firstname," ",t.lastname," ")}}function He(t,e){if(1&t){const t=o.Vb();o.Ub(0,"div",69),o.Ub(1,"mat-card",10),o.Ub(2,"mat-card-header"),o.Ub(3,"mat-card-title"),o.Mc(4,"Assign To User"),o.Tb(),o.Tb(),o.Ub(5,"mat-card-content"),o.Ub(6,"mat-form-field"),o.Ub(7,"mat-label"),o.Mc(8,"Select User"),o.Tb(),o.Pb(9,"input",81),o.Ub(10,"mat-autocomplete",54,82),o.cc("optionSelected",function(e){return o.Ac(t),o.gc().onUserSelectionChanged(e)}),o.Kc(12,Ee,2,3,"mat-option",13),o.hc(13,"async"),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb()}if(2&t){const t=o.xc(11),e=o.gc();o.Cb(9),o.oc("formControl",e.userNameCtrl)("matAutocomplete",t),o.Cb(1),o.oc("displayWith",e.displayUsers),o.Cb(2),o.oc("ngForOf",o.ic(13,4,e.filterUsers))}}function Ge(t,e){1&t&&(o.Ub(0,"span",88),o.Mc(1,"(Required)"),o.Tb())}function ze(t,e){1&t&&(o.Ub(0,"span",89),o.Mc(1,"(Attached)"),o.Tb())}const Be=function(t){return{error_box:t}};function We(t,e){if(1&t){const t=o.Vb();o.Ub(0,"div",83),o.Ub(1,"mat-card",10),o.Ub(2,"mat-card-header"),o.Ub(3,"mat-card-title"),o.Mc(4,"Attach File "),o.Kc(5,Ge,2,0,"span",84),o.Kc(6,ze,2,0,"span",85),o.Tb(),o.Tb(),o.Ub(7,"mat-card-content"),o.Ub(8,"div",43),o.Ub(9,"label",86),o.Mc(10,"Attach File"),o.Tb(),o.Ub(11,"input",87),o.cc("change",function(e){return o.Ac(t),o.gc().onAttachFileChange(e)}),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb()}if(2&t){const t=o.gc();o.oc("ngClass",o.sc(3,Be,!t.dataForm.controls.other.controls.attach_file.value)),o.Cb(5),o.oc("ngIf",!t.dataForm.controls.other.controls.attach_file.value),o.Cb(1),o.oc("ngIf",t.dataForm.controls.other.controls.attach_file.value)}}function Je(t,e){if(1&t&&(o.Ub(0,"mat-option",33),o.Mc(1),o.Tb()),2&t){const t=e.$implicit;o.oc("value",t.id),o.Cb(1),o.Oc(" ",t.name," ")}}function Qe(t,e){if(1&t&&o.Pb(0,"mat-progress-spinner",90),2&t){const t=o.gc();o.oc("value",t.percentCompleted)}}function Ze(t,e){1&t&&(o.Ub(0,"span"),o.Mc(1,"Submit"),o.Tb())}function Xe(t,e){1&t&&(o.Ub(0,"span"),o.Mc(1,"Update"),o.Tb())}function ti(t,e){if(1&t){const t=o.Vb();o.Ub(0,"button",92),o.cc("click",function(){return o.Ac(t),o.gc(2).submitForm()}),o.Kc(1,Ze,2,0,"span",1),o.Kc(2,Xe,2,0,"span",1),o.Tb()}if(2&t){const t=o.gc(2);o.oc("disabled",!t.dataForm.valid||!t.userNameCtrl.value),o.Cb(1),o.oc("ngIf",!t.editMode),o.Cb(1),o.oc("ngIf",t.editMode)}}function ei(t,e){if(1&t&&(o.Sb(0),o.Kc(1,ti,3,3,"button",91),o.Rb()),2&t){const t=o.gc();o.Cb(1),o.oc("ngIf",!t.submitted)}}function ii(t,e){1&t&&(o.Ub(0,"span"),o.Mc(1,"Submit"),o.Tb())}function ni(t,e){1&t&&(o.Ub(0,"span"),o.Mc(1,"Update"),o.Tb())}function ai(t,e){if(1&t){const t=o.Vb();o.Ub(0,"button",92),o.cc("click",function(){return o.Ac(t),o.gc(2).submitForm()}),o.Kc(1,ii,2,0,"span",1),o.Kc(2,ni,2,0,"span",1),o.Tb()}if(2&t){const t=o.gc(2);o.oc("disabled",!t.dataForm.valid),o.Cb(1),o.oc("ngIf",!t.editMode),o.Cb(1),o.oc("ngIf",t.editMode)}}function oi(t,e){if(1&t&&o.Kc(0,ai,3,3,"button",91),2&t){const t=o.gc();o.oc("ngIf",!t.submitted)}}function ci(t,e){if(1&t&&(o.Sb(0),o.Pb(1,"ngx-imageviewer",93),o.Rb()),2&t){const t=o.gc().data;o.Cb(1),o.oc("src",t.src)}}function si(t,e){if(1&t&&o.Kc(0,ci,2,1,"ng-container",1),2&t){const t=e.index,i=e.currIndex;o.oc("ngIf","imageViewer"===e.type&&t===i)}}let ri=(()=>{class t{constructor(t,e,i,n,a,o,s,l,d,m,p,h){this._snackBar=t,this.router=e,this.dialog=i,this.route=n,this.fb=a,this._manager=o,this._shipmentService=s,this.shipperService=l,this.receiverService=d,this.auth=m,this.gallery=p,this.lightbox=h,this.searchReceiverTerms={name:""},this.searchShipperTerms={name:""},this.shipmentHistory=[],this.lightboxRef=null,this.submitted=!1,this.history_files=[],this.users_list=[],this.shippers_list=[],this.receivers_list=[],this.destinations_list=[],this.warehouses_list=[],this.shipper_types=[],this.container_types=[],this.shippment_statuses=[],this.dataSource=new c.o(this.shippers_list),this.dataSource2=new c.o(this.receivers_list),this.userNameCtrl=new r.g("",[r.v.required]),this.minDate=b(),this.percentCompleted=0,this.isUploaded=!1,this.editMode=!1,this.permission={},this.isAdmin=!1,m.currentUserValue.permission&&(this.permission=m.currentUserValue.permission.shipment,this.permission.canassign?this.isAdmin=this.permission.canassign:1==m.currentUserValue.user_group_id&&(this.isAdmin=!0))}ngOnChanges(t){}ngOnInit(){this.resetForm(),this._shipmentService.getBulk().subscribe(t=>{t&&(this.shippers_list=t.shippers,this.activeShippers(),this.receivers_list=t.receivers,this.activeReceivers(),this.destinations_list=t.destinations,this.activeDestinations(),this.shipper_types=t.shipper_types,this.container_types=t.container_types,this.shippment_statuses=t.shipment_statuses.filter(t=>-1!==this.permission.statuses.indexOf(t.id)),this.shipmentId||this.dataForm.patchValue({history:{shipment_status_id:this.shippment_statuses[0].id}}),this.warehouses_list=t.warehouses,this.auth.getUsers().subscribe(t=>{t&&t&&(this.users_list=t.data,this.activeUsers()),this.activeParameters()}))}),this.lightboxRef=this.gallery.ref("lightbox"),this.lightboxRef.setConfig({imageSize:m.e.Contain,thumbPosition:m.f.Top,itemTemplate:this.itemTemplate,gestures:!1})}activeParameters(){this.sub=this.route.params.subscribe(t=>{this.shipmentId=+t.id,isNaN(this.shipmentId)?(this.editMode=!1,this.shipmentHistory=null,this.shipmentId=null,this.dataForm.get("other").get("attach_file").setValidators([r.v.required])):(this.editMode=!0,this.getShipment(this.shipmentId))})}activeDestinations(){this.filteredDestinations=this.dataForm.get("other").get("destination_name").valueChanges.pipe(Object(T.a)(""),Object(M.a)(t=>"string"==typeof t?t:t.name),Object(M.a)(t=>{var e;return t?this._filterDestination(t):null===(e=this.destinations_list)||void 0===e?void 0:e.slice()}))}activeUsers(){this.filterUsers=this.userNameCtrl.valueChanges.pipe(Object(T.a)(""),Object(M.a)(t=>"string"==typeof t?t:t.firstname+" "+t.lastname),Object(M.a)(t=>{var e;return t?this._filterUser(t):null===(e=this.users_list)||void 0===e?void 0:e.slice()}))}activeShippers(){this.filteredShippers=this.dataForm.get("shipper").get("name").valueChanges.pipe(Object(T.a)(""),Object(C.a)(500),Object(M.a)(t=>"string"==typeof t?t:t.name),Object(U.a)(t=>{var e;return t?this._filterShipper(t):Object(f.a)(null===(e=this.shippers_list)||void 0===e?void 0:e.slice())}))}activeReceivers(){this.filteredReceivers=this.dataForm.get("receiver").get("name").valueChanges.pipe(Object(T.a)(""),Object(C.a)(500),Object(M.a)(t=>"string"==typeof t?t:t.name),Object(U.a)(t=>{var e;return t?this._filterReceiver(t):Object(f.a)(null===(e=this.receivers_list)||void 0===e?void 0:e.slice())}))}resetForm(){this.dataForm=this.fb.group({shipper:this.fb.group({new:[""],shipper_id:[""],name:["",r.v.required],phone:["",r.v.required],address:["",r.v.required],email:["",[r.v.required,r.v.email]],ein:["",r.v.required],shipper_type_id:["",r.v.required]}),receiver:this.fb.group({new:[""],receiver_id:[""],name:["",r.v.required],phone:["",r.v.required],address:["",r.v.required],email:["",[r.v.required,r.v.email]]}),other:this.fb.group({date:[b(),r.v.required],container_type_id:["",r.v.required],destination_id:[""],destination_name:["",r.v.required],warehouse_id:["",r.v.required],akey:[0],title:[0],new_destination:[""],attach_file:[""],note:[""]}),history:this.fb.group({shipment_status_id:[""],note:[""],file:[""]}),packages:this.fb.array([],r.v.required)})}getShipment(t){const e=new FormData;e.append("shipment_id",t),this._shipmentService.getShipment(e).subscribe(t=>{if(t&&t.data){const e=t.data.data,i=t.data.shipper,n=t.data.receiver,a=t.data.destination,o=t.data.packages;this.shipmentHistory=t.data.history,this.dataForm.patchValue({shipper:{shipper_id:i.shipper_id,name:i.name,email:i.email,phone:i.phone,address:i.address,ein:i.ein,shipper_type_id:i.shipper_type_id},receiver:{receiver_id:n.receiver_id,name:n.name,email:n.email,phone:n.phone,address:n.address},other:{date:b(new Date(e.date)),container_type_id:e.container_type_id,title:parseInt(e.title),akey:parseInt(e.akey),warehouse_id:e.warehouse_id,destination_name:a.name,destination_id:a.id,note:e.note},history:{shipment_status_id:e.shipment_status_id}}),b(new Date(e.date)).isAfter(this.minDate);for(let t=0;t<o.length;t++){let e=JSON.parse(o[t].data);"1"==e.type?this.packageArray.push(this.fb.group({type:[parseInt(e.type)],year:[e.year,r.v.required],model:[e.model,r.v.required],mark:[e.mark,r.v.required],vin:[e.vin,r.v.required],value:[e.value],file:[""],input:[e.input]})):"2"==e.type&&this.packageArray.push(this.fb.group({type:[parseInt(e.type)],description:[e.description,r.v.required],value:[e.value,r.v.required],file:[""],input:[e.input]}))}}})}dateHandler(t,e){this.dataForm.get("other").get("date").setValue(b(e.value).format("MM/DD/YYYY"))}onFileChange(t){this.history_files=[];for(var e=0;e<t.target.files.length;e++)this.history_files.push(t.target.files[e])}onAttachFileChange(t){this.dataForm.get("other").get("attach_file").setValue(t.target.files[0])}deletePackage(t){this.packageArray.removeAt(t)}onPackageFileChange(t,e){this.packageArray.at(e).get("file").setValue(t.target.files[0])}get packageArray(){return this.dataForm.get("packages")}get shipperForm(){return this.dataForm.controls.shipper.controls}get receiverForm(){return this.dataForm.controls.receiver.controls}get otherForm(){return this.dataForm.controls.other.controls}addPackage(t){1==t?this.packageArray.push(this.fb.group({type:[t],year:["",r.v.required],model:["",r.v.required],mark:["",r.v.required],vin:["",r.v.required],value:["",r.v.required],file:[""],input:[""]})):2==t&&this.packageArray.push(this.fb.group({type:[t],description:["",r.v.required],value:["",r.v.required],file:[""],input:[""]}))}newShipperChange(t){t.checked&&this.dataForm.patchValue({shipper:{shipper_id:"",name:"",phone:"",address:"",email:"",ein:"",shipper_type_id:""}})}newReceiverChange(t){t.checked&&this.dataForm.patchValue({receiver:{receiver_id:"",name:"",phone:"",address:"",email:""}})}newDestinationChange(t){t.checked&&this.dataForm.patchValue({other:{destination_id:"",destination_name:""}})}removePackage(t){this.packageArray.removeAt(t)}openGallery(t){t.file.length>0&&(this.gallery_items=t.file.map(t=>new m.d({src:t,thumb:t})),this.lightboxRef.load(this.gallery_items),this.lightbox.open(0,"lightbox",{panelClass:"fullscreen"}))}openEditFiles(t){this.dialog.open(le,{data:{item:t,type:"shipment"}}).afterClosed().subscribe(t=>{})}downloadGallery(t){let e=new FormData;e.append("history_id",t.history_id),this._shipmentService.downloadHistoryItem(e).subscribe(t=>{t.history_file&&window.open(t.history_file,"_blank")},t=>{this.submitted=!1})}downloadShipmentGallery(){let t=new FormData;t.append("shipment_id",this.shipmentId.toString()),this._shipmentService.downloadHistoryItem(t).subscribe(t=>{t.history_file&&window.open(t.history_file,"_blank")},t=>{this.submitted=!1})}openImage(t){this.dialog.open(ce.a,{data:{url:t}}).afterClosed().subscribe(t=>{})}submitForm(){this.submitted=!0;let t=new FormData,e=JSON.parse(JSON.stringify(this.dataForm.value));e.other.attach_file=this.dataForm.get("other").get("attach_file").value,this.jsonToFormData(t,e);for(var i=0;i<this.history_files.length;i++)t.append("history_files[]",this.history_files[i]);this.shipmentId&&t.append("shipment_id",this.shipmentId.toString()),this.userNameCtrl.value&&t.append("assigned_user_id",this.userNameCtrl.value.user_id),t.append("shipment_link",se.a.home+"admin/shipments/info/"),this._shipmentService.saveShipment(t).subscribe(t=>{t.type===ae.d.UploadProgress?this.percentCompleted=Math.round(100*t.loaded/t.total):t instanceof ae.e&&(this.isUploaded=!0,this.submitted=!1,this.openSnackBar("Data submited successfully",""),this.shipmentId||this.router.navigate(["/admin/shipments/list"]),console.log("success"))},t=>{this.submitted=!1,this.openSnackBar("Something wrong happen!",""),console.log("error")})}openSnackBar(t,e){this._snackBar.open(t,e,{duration:2e3})}buildFormData(t,e,i){!e||"object"!=typeof e||e instanceof Date||e instanceof File?t.append(i,null==e?"":e):Object.keys(e).forEach(n=>{this.buildFormData(t,e[n],i?`${i}[${n}]`:n)})}jsonToFormData(t,e){this.buildFormData(t,e,"")}displayShipper(t){return t&&t.name?t.name:""}displayReceiver(t){return t&&t.name?t.name:""}displayDestination(t){return t&&t.name?t.name:""}displayUsers(t){return t&&t.firstname?t.firstname+" "+t.lastname:""}onUserSelectionChanged(t){this.userNameCtrl.setValue(t.option.value)}onDestinationSelectionChanged(t){const e=t.option.value;this.dataForm.patchValue({other:{destination_id:e.id,destination_name:e.name}})}onShipperSelectionChanged(t){const e=t.option.value;this.dataForm.patchValue({shipper:{shipper_id:e.shipper_id,name:e.name,phone:e.phone,address:e.address,email:e.email,ein:e.ein,shipper_type_id:e.shipper_type_id}})}onNewShipperChange(t){this.dataForm.get("shipper").get("name").setValue("")}onReceiverSelectionChanged(t){this.dataForm.get("receiver").get("name").setValue(t.option.value);const e=t.option.value;this.dataForm.patchValue({receiver:{receiver_id:e.receiver_id,name:e.name,phone:e.phone,address:e.address,email:e.email}})}_filterUser(t){var e;const i=t.toLowerCase();return null===(e=this.users_list)||void 0===e?void 0:e.filter(t=>0===(t.firstname+" "+t.lastname).toLowerCase().indexOf(i))}_filterShipper(t){return this.searchShipperTerms.name=t,this.shipperService.getShippers({page:1,filter:Object.keys(this.searchShipperTerms).map(t=>t+"___"+this.searchShipperTerms[t]).join("|")}).pipe(Object(M.a)(t=>t.items?t.items:[]))}_filterReceiver(t){return this.searchReceiverTerms.name=t,this.receiverService.getReceivers({page:1,filter:Object.keys(this.searchReceiverTerms).map(t=>t+"___"+this.searchReceiverTerms[t]).join("|")}).pipe(Object(M.a)(t=>t.items?t.items:[]))}_filterDestination(t){var e;const i=t.toLowerCase();return null===(e=this.destinations_list)||void 0===e?void 0:e.filter(t=>0===t.name.toLowerCase().indexOf(i))}openReceiverDialog(){this.dialog.open(ne.a,{width:"450px"}).afterClosed().subscribe(t=>{})}dateFilter(t){let e=this.dataForm.controls.other.controls.date.value;return e&&e.format("MM/DD/YYYY")==t.format("MM/DD/YYYY")||new Date(t.format("MM/DD/YYYY"))>=new Date(this.minDate.format("MM/DD/YYYY"))}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(O.a),o.Ob(a.e),o.Ob(y.b),o.Ob(a.a),o.Ob(r.f),o.Ob(D.a),o.Ob(P.a),o.Ob(de.a),o.Ob(me.a),o.Ob(K.a),o.Ob(m.a),o.Ob(R.a))},t.\u0275cmp=o.Ib({type:t,selectors:[["app-createshipments"]],viewQuery:function(t,e){var i;1&t&&o.Rc(ge,!0),2&t&&o.wc(i=o.dc())&&(e.itemTemplate=i.first)},features:[o.Bb([{provide:V.c,useClass:oe.b,deps:[V.f]},{provide:V.e,useValue:oe.a}]),o.Ab],decls:177,vars:36,consts:[[1,"cs-page-header"],[4,"ngIf"],[1,"cs-right"],["mat-flat-button","",3,"routerLink"],["mat-list-icon",""],[1,"cs-box",3,"formGroup"],[1,"col","col3-1"],["class","main_header",4,"ngIf"],[1,"col","col2"],["formGroupName","shipper"],[1,"cs-card"],["formControlName","new",3,"change"],["formControlName","shipper_type_id"],[3,"value",4,"ngFor","ngForOf"],["type","text","matInput","","formControlName","phone"],["type","text","matInput","","formControlName","address"],["type","text","matInput","","formControlName","email"],["type","text","matInput","","formControlName","ein"],["formGroupName","receiver"],["formArrayName","packages",1,"col"],[1,"cs-plist"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"cs-button-holder"],["mat-raised-button","","color","warn",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["class","col",4,"ngIf"],["formGroupName","other",1,"col"],["matInput","","formControlName","date","placeholder","Date",3,"matDatepickerFilter","matDatepicker"],["matSuffix","",3,"for"],["pickpicker",""],["formControlName","container_type_id"],["formControlName","title"],[3,"value"],["formControlName","akey"],[1,"frtoggle"],["formControlName","new_destination",3,"change"],["formControlName","warehouse_id"],["matInput","","formControlName","note"],["class","col",3,"ngClass",4,"ngIf"],[1,"col","hprint"],["formArrayName","history",1,"cs-card"],["formControlName","shipment_status_id"],[1,"fupload"],["for","ifile"],["type","file","id","ifile","multiple","","accept",".png, .jpg, .jpeg",3,"change"],[1,"form-add"],["class","loader_spinner","color","primary","mode","determinate",3,"value",4,"ngIf"],[4,"ngIf","ngIfElse"],["normalButton",""],["itemTemplate",""],[1,"main_header"],["type","text","matInput","","value","","autocomplete","off","formControlName","name",3,"ngClass"],["type","text","matInput","","formControlName","name","autocomplete","off",3,"matAutocomplete"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],["type","text","matInput","","formControlName","name","autocomplete","off"],["auto2","matAutocomplete"],[3,"formGroupName"],["type","text","matInput","","formControlName","year"],["type","text","matInput","","formControlName","model"],["type","text","matInput","","formControlName","mark"],["type","text","matInput","","formControlName","vin"],["type","text","matInput","","formControlName","value"],["matPrefix",""],[1,"fipt"],["mat-raised-button","","color","warn",3,"click"],[1,"long_txt"],["type","text","matInput","","formControlName","description"],[1,"col"],["mat-button","",1,"hdownload",3,"click"],[1,"ct_holder"],[1,"gtable"],[4,"ngFor","ngForOf"],["mat-button","","disabled","",4,"ngIf"],["mat-button","",3,"click",4,"ngIf"],["mat-button","","disabled",""],["mat-button","",3,"click"],["type","text","matInput","","formControlName","destination_name"],["type","text","matInput","","formControlName","destination_name",3,"matAutocomplete"],["auto3","matAutocomplete"],["type","text","matInput","",3,"formControl","matAutocomplete"],["auto_user","matAutocomplete"],[1,"col",3,"ngClass"],["class","error_title",4,"ngIf"],["class","success_title",4,"ngIf"],["for","ifile2"],["type","file","id","ifile2","accept",".png, .jpg, .jpeg,.txt, .pdf,.doc,.docx,.zip",3,"change"],[1,"error_title"],[1,"success_title"],["color","primary","mode","determinate",1,"loader_spinner",3,"value"],["mat-raised-button","","color","warn",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","warn",3,"disabled","click"],[3,"src"]],template:function(t,e){if(1&t&&(o.Ub(0,"div",0),o.Kc(1,fe,4,0,"span",1),o.Kc(2,_e,4,0,"span",1),o.Ub(3,"div",2),o.Ub(4,"a",3),o.Ub(5,"mat-icon",4),o.Mc(6,"keyboard_arrow_left"),o.Tb(),o.Mc(7," Back "),o.Tb(),o.Tb(),o.Tb(),o.Ub(8,"form",5),o.Ub(9,"div",6),o.Ub(10,"div"),o.Kc(11,Ce,3,3,"div",7),o.Ub(12,"div",8),o.Ub(13,"div",9),o.Ub(14,"mat-card",10),o.Ub(15,"mat-card-header"),o.Ub(16,"mat-card-title"),o.Mc(17," Shipper Information "),o.Tb(),o.Ub(18,"span"),o.Ub(19,"mat-slide-toggle",11),o.cc("change",function(t){return e.newShipperChange(t)}),o.Mc(20,"Add New"),o.Tb(),o.Tb(),o.Tb(),o.Ub(21,"mat-card-content"),o.Ub(22,"mat-form-field"),o.Ub(23,"mat-label"),o.Mc(24,"Shipper Name"),o.Tb(),o.Kc(25,Ue,2,3,"ng-container",1),o.Kc(26,ve,6,5,"ng-container",1),o.Tb(),o.Ub(27,"mat-form-field"),o.Ub(28,"mat-label"),o.Mc(29,"Type"),o.Tb(),o.Ub(30,"mat-select",12),o.Kc(31,ye,2,2,"mat-option",13),o.Tb(),o.Tb(),o.Ub(32,"mat-form-field"),o.Ub(33,"mat-label"),o.Mc(34,"Phone Number"),o.Tb(),o.Pb(35,"input",14),o.Tb(),o.Ub(36,"mat-form-field"),o.Ub(37,"mat-label"),o.Mc(38,"Address"),o.Tb(),o.Pb(39,"input",15),o.Tb(),o.Ub(40,"mat-form-field"),o.Ub(41,"mat-label"),o.Mc(42,"Email"),o.Tb(),o.Pb(43,"input",16),o.Tb(),o.Ub(44,"mat-form-field"),o.Ub(45,"mat-label"),o.Mc(46,"EIN|Passport No"),o.Tb(),o.Pb(47,"input",17),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Ub(48,"div",18),o.Ub(49,"mat-card",10),o.Ub(50,"mat-card-header"),o.Ub(51,"mat-card-title"),o.Mc(52,"Receiver Information"),o.Tb(),o.Ub(53,"span"),o.Ub(54,"mat-slide-toggle",11),o.cc("change",function(t){return e.newReceiverChange(t)}),o.Mc(55,"Add New"),o.Tb(),o.Tb(),o.Tb(),o.Ub(56,"mat-card-content"),o.Ub(57,"mat-form-field"),o.Ub(58,"mat-label"),o.Mc(59,"Receiver Name"),o.Tb(),o.Kc(60,Oe,2,0,"ng-container",1),o.Kc(61,we,6,5,"ng-container",1),o.Tb(),o.Ub(62,"mat-form-field"),o.Ub(63,"mat-label"),o.Mc(64,"Phone Number"),o.Tb(),o.Pb(65,"input",14),o.Tb(),o.Ub(66,"mat-form-field"),o.Ub(67,"mat-label"),o.Mc(68,"Address"),o.Tb(),o.Pb(69,"input",15),o.Tb(),o.Ub(70,"mat-form-field"),o.Ub(71,"mat-label"),o.Mc(72,"Email"),o.Tb(),o.Pb(73,"input",16),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Ub(74,"div",19),o.Ub(75,"mat-card",10),o.Ub(76,"mat-card-header"),o.Ub(77,"mat-card-title"),o.Mc(78,"Shipment Information"),o.Tb(),o.Tb(),o.Ub(79,"mat-card-content"),o.Ub(80,"div"),o.Ub(81,"div",20),o.Kc(82,xe,3,3,"div",21),o.Tb(),o.Ub(83,"div",22),o.Ub(84,"button",23),o.Mc(85,"Add New"),o.Tb(),o.Ub(86,"mat-menu",null,24),o.Ub(88,"button",25),o.cc("click",function(){return e.addPackage(1)}),o.Mc(89,"Vehicles"),o.Tb(),o.Ub(90,"button",25),o.cc("click",function(){return e.addPackage(2)}),o.Mc(91,"Other Commodities"),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Kc(92,Ve,26,2,"div",26),o.Tb(),o.Ub(93,"div"),o.Ub(94,"div",27),o.Ub(95,"mat-card",10),o.Ub(96,"mat-card-header"),o.Ub(97,"mat-card-title"),o.Mc(98,"Other Information"),o.Tb(),o.Tb(),o.Ub(99,"mat-card-content"),o.Ub(100,"mat-form-field"),o.Pb(101,"input",28),o.Pb(102,"mat-datepicker-toggle",29),o.Pb(103,"mat-datepicker",null,30),o.Tb(),o.Ub(105,"mat-form-field"),o.Ub(106,"mat-label"),o.Mc(107,"Cargo Type"),o.Tb(),o.Ub(108,"mat-select",31),o.Kc(109,$e,2,2,"mat-option",13),o.Tb(),o.Tb(),o.Ub(110,"mat-form-field"),o.Ub(111,"mat-label"),o.Mc(112,"Title"),o.Tb(),o.Ub(113,"mat-select",32),o.Ub(114,"mat-option",33),o.Mc(115," No "),o.Tb(),o.Ub(116,"mat-option",33),o.Mc(117," Yes "),o.Tb(),o.Ub(118,"mat-option",33),o.Mc(119," N/A "),o.Tb(),o.Tb(),o.Tb(),o.Ub(120,"mat-form-field"),o.Ub(121,"mat-label"),o.Mc(122,"Key"),o.Tb(),o.Ub(123,"mat-select",34),o.Ub(124,"mat-option",33),o.Mc(125," No "),o.Tb(),o.Ub(126,"mat-option",33),o.Mc(127," Yes "),o.Tb(),o.Ub(128,"mat-option",33),o.Mc(129," N/A "),o.Tb(),o.Tb(),o.Tb(),o.Ub(130,"mat-form-field"),o.Ub(131,"span",35),o.Ub(132,"mat-slide-toggle",36),o.cc("change",function(t){return e.newDestinationChange(t)}),o.Mc(133,"Add New"),o.Tb(),o.Tb(),o.Ub(134,"mat-label"),o.Mc(135,"Destination"),o.Tb(),o.Kc(136,Le,2,0,"ng-container",1),o.Kc(137,Ye,6,5,"ng-container",1),o.Tb(),o.Ub(138,"mat-form-field"),o.Ub(139,"mat-label"),o.Mc(140,"Warehouse"),o.Tb(),o.Ub(141,"mat-select",37),o.Kc(142,qe,2,2,"mat-option",13),o.Ub(143,"mat-option",33),o.Mc(144,"None"),o.Tb(),o.Tb(),o.Tb(),o.Ub(145,"mat-form-field"),o.Ub(146,"mat-label"),o.Mc(147,"Your Note"),o.Tb(),o.Pb(148,"textarea",38),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Kc(149,He,14,6,"div",26),o.Kc(150,We,12,5,"div",39),o.Ub(151,"div",40),o.Ub(152,"mat-card",41),o.Ub(153,"mat-card-header"),o.Ub(154,"mat-card-title"),o.Mc(155,"History"),o.Tb(),o.Tb(),o.Ub(156,"mat-card-content"),o.Ub(157,"mat-form-field"),o.Ub(158,"mat-label"),o.Mc(159,"Status"),o.Tb(),o.Ub(160,"mat-select",42),o.Kc(161,Je,2,2,"mat-option",13),o.Tb(),o.Tb(),o.Ub(162,"mat-form-field"),o.Ub(163,"mat-label"),o.Mc(164,"Note"),o.Tb(),o.Pb(165,"textarea",38),o.Tb(),o.Ub(166,"div",43),o.Ub(167,"label",44),o.Mc(168,"Attach Image"),o.Tb(),o.Ub(169,"input",45),o.cc("change",function(t){return e.onFileChange(t)}),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Ub(170,"div",46),o.Kc(171,Qe,1,1,"mat-progress-spinner",47),o.Kc(172,ei,2,1,"ng-container",48),o.Kc(173,oi,1,1,"ng-template",null,49,o.Lc),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Kc(175,si,1,1,"ng-template",null,50,o.Lc)),2&t){const t=o.xc(87),i=o.xc(104),n=o.xc(174);o.Cb(1),o.oc("ngIf",!e.editMode),o.Cb(1),o.oc("ngIf",e.editMode),o.Cb(2),o.oc("routerLink","/admin/shipments/list"),o.Cb(4),o.oc("formGroup",e.dataForm),o.Cb(3),o.oc("ngIf",e.shipmentId),o.Cb(14),o.oc("ngIf",e.dataForm.controls.shipper.controls.new.value),o.Cb(1),o.oc("ngIf",!e.dataForm.controls.shipper.controls.new.value),o.Cb(5),o.oc("ngForOf",e.shipper_types),o.Cb(29),o.oc("ngIf",e.dataForm.controls.receiver.controls.new.value),o.Cb(1),o.oc("ngIf",!e.dataForm.controls.receiver.controls.new.value),o.Cb(21),o.oc("ngForOf",e.dataForm.controls.packages.controls),o.Cb(2),o.oc("matMenuTriggerFor",t),o.Cb(8),o.oc("ngIf",e.shipmentHistory),o.Cb(9),o.oc("matDatepickerFilter",e.dateFilter.bind(e))("matDatepicker",i),o.Cb(1),o.oc("for",i),o.Cb(7),o.oc("ngForOf",e.container_types),o.Cb(4),o.Db("disabled",!e.permission.title),o.Cb(1),o.oc("value",0),o.Cb(2),o.oc("value",1),o.Cb(2),o.oc("value",2),o.Cb(5),o.Db("disabled",!e.permission.key),o.Cb(1),o.oc("value",0),o.Cb(2),o.oc("value",1),o.Cb(2),o.oc("value",2),o.Cb(8),o.oc("ngIf",e.dataForm.controls.other.controls.new_destination.value),o.Cb(1),o.oc("ngIf",!e.dataForm.controls.other.controls.new_destination.value),o.Cb(5),o.oc("ngForOf",e.warehouses_list),o.Cb(1),o.oc("value",0),o.Cb(6),o.oc("ngIf",!e.shipmentId&&e.isAdmin),o.Cb(1),o.oc("ngIf",!e.shipmentId),o.Cb(10),o.Db("disabled",!e.shipmentId),o.Cb(1),o.oc("ngForOf",e.shippment_statuses),o.Cb(10),o.oc("ngIf",e.submitted),o.Cb(1),o.oc("ngIf",!e.shipmentId&&e.isAdmin)("ngIfElse",n)}},directives:[n.l,S.a,a.h,w.a,k.b,r.w,r.r,r.j,r.k,pe.a,pe.c,pe.e,he.a,r.q,r.i,pe.b,I.b,I.e,A.a,n.k,x.b,r.d,r.e,S.b,j.c,j.d,j.a,$.b,$.d,I.g,$.a,V.o,n.j,ue.c,ue.a,I.f,r.h,L.a,q.b],pipes:[E,n.b],styles:["mat-card[_ngcontent-%COMP%]     .mat-card-header-text{margin:0}.hdownload[_ngcontent-%COMP%]{line-height:1;margin-top:-10px;min-width:20px;padding:0 10px}.error_title[_ngcontent-%COMP%]{color:#dc0000}.success_title[_ngcontent-%COMP%]{color:#00c531}.chk_box[_ngcontent-%COMP%]{padding:0;list-style:none}.chk_box[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-block;margin-right:20px}mat-form-field[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]     .mat-form-field-infix{padding:10px 0}.form-add[_ngcontent-%COMP%]{display:inline-block;margin-top:20px}.form-add[_ngcontent-%COMP%], .form-add[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.frtoggle[_ngcontent-%COMP%]{display:inline-block;float:right;margin-top:-24px;transform:translateY(15px)}.cs-plist[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:17%;padding-right:3%}.cs-plist[_ngcontent-%COMP%]   mat-form-field.long_txt[_ngcontent-%COMP%]{width:68%!important}.fipt[_ngcontent-%COMP%]{width:15%;display:inline-block}.fipt[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.fipt[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;width:100%;text-align:center;background:#ececec;padding:12px 1px;border-radius:4px;border:1px solid #c7c7c7;font-weight:700}.cs-plist[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:block}.cs-button-holder[_ngcontent-%COMP%]{display:block;padding:10ox 0}.loader_spinner[_ngcontent-%COMP%]{margin:20px auto}@media screen and (max-width:900px){.ct_holder[_ngcontent-%COMP%]{overflow:auto}.ct_holder[_ngcontent-%COMP%]   .gtable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap}.cs-plist[_ngcontent-%COMP%]{margin-bottom:20px}.cs-plist[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%;padding-right:0}.cs-plist[_ngcontent-%COMP%]   mat-form-field.long_txt[_ngcontent-%COMP%]{width:100%!important}}"]}),t})();const bi=["content"],li=["itemTemplate"];function di(t,e){1&t&&(o.Ub(0,"span"),o.Ub(1,"mat-icon",4),o.Mc(2,"edit"),o.Tb(),o.Mc(3," Shipment Info"),o.Tb())}function mi(t,e){if(1&t){const t=o.Vb();o.Sb(0),o.Ub(1,"button",7),o.cc("click",function(){return o.Ac(t),o.gc().printPage()}),o.fc(),o.Ub(2,"svg"),o.Pb(3,"use",8),o.Tb(),o.Tb(),o.ec(),o.Ub(4,"button",7),o.cc("click",function(){return o.Ac(t),o.gc().savePDF()}),o.fc(),o.Ub(5,"svg"),o.Pb(6,"use",9),o.Tb(),o.Tb(),o.Rb()}}function pi(t,e){if(1&t&&(o.Ub(0,"div",19),o.Mc(1),o.hc(2,"zeroid"),o.Tb()),2&t){const t=o.gc(2);o.Cb(1),o.Oc(" Tracking ID ",o.ic(2,1,t.shipmentId)," ")}}function hi(t,e){if(1&t&&(o.Ub(0,"div",22),o.Ub(1,"div"),o.Ub(2,"h2"),o.Mc(3,"Year"),o.Tb(),o.Ub(4,"h4"),o.Mc(5),o.Tb(),o.Tb(),o.Ub(6,"div"),o.Ub(7,"h2"),o.Mc(8,"Model"),o.Tb(),o.Ub(9,"h4"),o.Mc(10),o.Tb(),o.Tb(),o.Ub(11,"div"),o.Ub(12,"h2"),o.Mc(13,"Make"),o.Tb(),o.Ub(14,"h4"),o.Mc(15),o.Tb(),o.Tb(),o.Ub(16,"div"),o.Ub(17,"h2"),o.Mc(18,"Vin"),o.Tb(),o.Ub(19,"h4"),o.Mc(20),o.Tb(),o.Tb(),o.Ub(21,"div"),o.Ub(22,"h2"),o.Mc(23,"Value"),o.Tb(),o.Ub(24,"h4"),o.Mc(25),o.Tb(),o.Tb(),o.Tb()),2&t){const t=o.gc().$implicit;o.Cb(5),o.Nc(t.year),o.Cb(5),o.Nc(t.model),o.Cb(5),o.Nc(t.mark),o.Cb(5),o.Nc(t.vin),o.Cb(5),o.Oc("$",t.value,"")}}function ui(t,e){if(1&t&&(o.Ub(0,"div",23),o.Ub(1,"div"),o.Ub(2,"h2"),o.Mc(3,"Description"),o.Tb(),o.Ub(4,"h4"),o.Mc(5),o.Tb(),o.Tb(),o.Ub(6,"div"),o.Ub(7,"h2"),o.Mc(8,"Value"),o.Tb(),o.Ub(9,"h4"),o.Mc(10),o.Tb(),o.Tb(),o.Tb()),2&t){const t=o.gc().$implicit;o.Cb(5),o.Nc(t.description),o.Cb(5),o.Oc("$",t.value,"")}}function gi(t,e){if(1&t&&(o.Ub(0,"div"),o.Kc(1,hi,26,5,"div",20),o.Kc(2,ui,11,2,"div",21),o.Tb()),2&t){const t=e.$implicit;o.Cb(1),o.oc("ngIf",1==t.type),o.Cb(1),o.oc("ngIf",2==t.type)}}function fi(t,e){1&t&&(o.Ub(0,"th"),o.Mc(1,"Added By"),o.Tb())}function _i(t,e){1&t&&(o.Ub(0,"button",28),o.Ub(1,"mat-icon"),o.Mc(2,"image"),o.Tb(),o.Tb())}function Ci(t,e){if(1&t){const t=o.Vb();o.Ub(0,"button",29),o.cc("click",function(){o.Ac(t);const e=o.gc().$implicit;return o.gc(3).openGallery(e)}),o.Ub(1,"mat-icon"),o.Mc(2,"image"),o.Tb(),o.Tb()}}function Ti(t,e){if(1&t&&(o.Ub(0,"td"),o.Mc(1),o.Tb()),2&t){const t=o.gc().$implicit;o.Cb(1),o.Nc(t.username)}}function Ui(t,e){if(1&t){const t=o.Vb();o.Ub(0,"button",29),o.cc("click",function(){o.Ac(t);const e=o.gc().$implicit;return o.gc(3).openEditFiles(e)}),o.Ub(1,"mat-icon"),o.Mc(2,"edit"),o.Tb(),o.Tb()}}function Mi(t,e){if(1&t){const t=o.Vb();o.Ub(0,"button",29),o.cc("click",function(){o.Ac(t);const e=o.gc().$implicit;return o.gc(3).downloadGallery(e)}),o.Ub(1,"mat-icon"),o.Mc(2,"cloud_download"),o.Tb(),o.Tb()}}function vi(t,e){if(1&t&&(o.Ub(0,"tr"),o.Ub(1,"td"),o.Mc(2),o.Tb(),o.Ub(3,"td"),o.Kc(4,_i,3,0,"button",26),o.Kc(5,Ci,3,0,"button",27),o.Tb(),o.Kc(6,Ti,2,1,"td",1),o.Ub(7,"td"),o.Mc(8),o.Tb(),o.Ub(9,"td"),o.Mc(10),o.Tb(),o.Ub(11,"td"),o.Kc(12,Ui,3,0,"button",27),o.Kc(13,Mi,3,0,"button",27),o.Tb(),o.Tb()),2&t){const t=e.$implicit,i=o.gc(3);o.Cb(2),o.Nc(t.name),o.Cb(2),o.oc("ngIf",!t.file),o.Cb(1),o.oc("ngIf",t.file),o.Cb(1),o.oc("ngIf",i.permission.show_user_column),o.Cb(2),o.Nc(t.note),o.Cb(2),o.Nc(t.date_added),o.Cb(2),o.oc("ngIf",i.permission.control_history_gallery&&t.file),o.Cb(1),o.oc("ngIf",t.file)}}function yi(t,e){if(1&t){const t=o.Vb();o.Ub(0,"div",15),o.Ub(1,"mat-card",14),o.Ub(2,"mat-card-header"),o.Ub(3,"mat-card-title"),o.Mc(4,"Shipment History"),o.Tb(),o.Ub(5,"button",24),o.cc("click",function(){return o.Ac(t),o.gc(2).downloadShipmentGallery()}),o.Ub(6,"mat-icon"),o.Mc(7,"cloud_download"),o.Tb(),o.Tb(),o.Tb(),o.Ub(8,"mat-card-content"),o.Ub(9,"div"),o.Ub(10,"div"),o.Ub(11,"table",25),o.Ub(12,"thead"),o.Ub(13,"th"),o.Mc(14,"Shipment Status"),o.Tb(),o.Ub(15,"th"),o.Mc(16,"Image"),o.Tb(),o.Kc(17,fi,2,0,"th",1),o.Ub(18,"th"),o.Mc(19,"Note"),o.Tb(),o.Ub(20,"th"),o.Mc(21,"Added Date"),o.Tb(),o.Ub(22,"th"),o.Mc(23,"Actions"),o.Tb(),o.Tb(),o.Ub(24,"tbody"),o.Kc(25,vi,14,8,"tr",17),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb()}if(2&t){const t=o.gc(2);o.Cb(17),o.oc("ngIf",t.permission.show_user_column),o.Cb(8),o.oc("ngForOf",t.info.history)}}function Oi(t,e){if(1&t&&(o.Ub(0,"div",10),o.Ub(1,"div",11),o.Ub(2,"div"),o.Kc(3,pi,3,3,"div",12),o.Ub(4,"div",13),o.Ub(5,"div"),o.Ub(6,"mat-card",14),o.Ub(7,"mat-card-header"),o.Ub(8,"mat-card-title"),o.Mc(9," Shipper Information "),o.Tb(),o.Tb(),o.Ub(10,"mat-card-content"),o.Ub(11,"h2"),o.Mc(12,"Shipper Name"),o.Tb(),o.Ub(13,"h4"),o.Mc(14),o.Tb(),o.Ub(15,"h2"),o.Mc(16,"Type"),o.Tb(),o.Ub(17,"h4"),o.Mc(18),o.Tb(),o.Ub(19,"h2"),o.Mc(20,"Phone Number"),o.Tb(),o.Ub(21,"h4"),o.Mc(22),o.Tb(),o.Ub(23,"h2"),o.Mc(24,"Address"),o.Tb(),o.Ub(25,"h4"),o.Mc(26),o.Tb(),o.Ub(27,"h2"),o.Mc(28,"Email"),o.Tb(),o.Ub(29,"h4"),o.Mc(30),o.Tb(),o.Ub(31,"h2"),o.Mc(32,"EIN|Passport No"),o.Tb(),o.Ub(33,"h4"),o.Mc(34),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Ub(35,"div"),o.Ub(36,"mat-card",14),o.Ub(37,"mat-card-header"),o.Ub(38,"mat-card-title"),o.Mc(39,"Receiver Information"),o.Tb(),o.Tb(),o.Ub(40,"mat-card-content"),o.Ub(41,"h2"),o.Mc(42,"Receiver Name"),o.Tb(),o.Ub(43,"h4"),o.Mc(44),o.Tb(),o.Ub(45,"h2"),o.Mc(46,"Phone Number"),o.Tb(),o.Ub(47,"h4"),o.Mc(48),o.Tb(),o.Ub(49,"h2"),o.Mc(50,"Address"),o.Tb(),o.Ub(51,"h4"),o.Mc(52),o.Tb(),o.Ub(53,"h2"),o.Mc(54,"Email"),o.Tb(),o.Ub(55,"h4"),o.Mc(56),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Ub(57,"div",15),o.Ub(58,"mat-card",14),o.Ub(59,"mat-card-header"),o.Ub(60,"mat-card-title"),o.Mc(61,"Shipment Information"),o.Tb(),o.Tb(),o.Ub(62,"mat-card-content"),o.Ub(63,"div"),o.Ub(64,"div",16),o.Kc(65,gi,3,2,"div",17),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Kc(66,yi,26,2,"div",18),o.Tb(),o.Ub(67,"div"),o.Ub(68,"div",15),o.Ub(69,"mat-card",14),o.Ub(70,"mat-card-header"),o.Ub(71,"mat-card-title"),o.Mc(72,"Other Information"),o.Tb(),o.Tb(),o.Ub(73,"mat-card-content"),o.Ub(74,"h2"),o.Mc(75,"Date"),o.Tb(),o.Ub(76,"h4"),o.Mc(77),o.Tb(),o.Ub(78,"h2"),o.Mc(79,"Cargo Type"),o.Tb(),o.Ub(80,"h4"),o.Mc(81),o.Tb(),o.Ub(82,"h2"),o.Mc(83,"Title"),o.Tb(),o.Ub(84,"h4"),o.Mc(85),o.hc(86,"yesno"),o.Tb(),o.Ub(87,"h2"),o.Mc(88,"Key"),o.Tb(),o.Ub(89,"h4"),o.Mc(90),o.hc(91,"yesno"),o.Tb(),o.Ub(92,"h2"),o.Mc(93,"Destination"),o.Tb(),o.Ub(94,"h4"),o.Mc(95),o.Tb(),o.Ub(96,"h2"),o.Mc(97,"Warehouse"),o.Tb(),o.Ub(98,"h4"),o.Mc(99),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb()),2&t){const t=o.gc();o.Cb(3),o.oc("ngIf",t.shipmentId),o.Cb(11),o.Nc(t.info.shipper.name),o.Cb(4),o.Nc(t.shipperType),o.Cb(4),o.Nc(t.info.shipper.phone),o.Cb(4),o.Nc(t.info.shipper.address),o.Cb(4),o.Nc(t.info.shipper.email),o.Cb(4),o.Nc(t.info.shipper.ein),o.Cb(10),o.Nc(t.info.receiver.name),o.Cb(4),o.Nc(t.info.receiver.phone),o.Cb(4),o.Nc(t.info.receiver.address),o.Cb(4),o.Nc(t.info.receiver.email),o.Cb(9),o.oc("ngForOf",t.info.packages),o.Cb(1),o.oc("ngIf",t.shipmentHistory),o.Cb(11),o.Nc(t.info.other.date),o.Cb(4),o.Nc(t.containerType),o.Cb(4),o.Nc(o.ic(86,19,t.info.other.title)),o.Cb(5),o.Nc(o.ic(91,21,t.info.other.akey)),o.Cb(5),o.Nc(t.info.other.destination_name),o.Cb(4),o.Nc(t.info.other.warehouse_name)}}function Pi(t,e){if(1&t&&(o.Sb(0),o.Pb(1,"ngx-imageviewer",30),o.Rb()),2&t){const t=o.gc().data;o.Cb(1),o.oc("src",t.src)}}function wi(t,e){if(1&t&&o.Kc(0,Pi,2,1,"ng-container",1),2&t){const t=e.index,i=e.currIndex;o.oc("ngIf","imageViewer"===e.type&&t===i)}}const ki=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:ie},{path:":id",component:ri},{path:"add",component:ri},{path:"info/:id",component:(()=>{class t{constructor(t,e,i,n,a,o,c,s,r){this.exportAsService=t,this.router=e,this.dialog=i,this.route=n,this._manager=a,this._shipmentService=o,this.auth=c,this.gallery=s,this.lightbox=r,this.lightboxRef=null,this.exportAsConfig={type:"pdf",elementIdOrContent:"content"},this.shipmentHistory=[],this.editMode=!1,this.submitted=!1,this.info={},this.shipperType="",this.shipper_types=[],this.destinations_list=[],this.permission={},c.currentUserValue.permission&&(this.permission=c.currentUserValue.permission.shipment)}ngOnInit(){this.info={shipper:{shipper_id:"",name:"",email:"",phone:"",address:"",ein:"",shipper_type_id:""},receiver:{receiver_id:"",name:"",email:"",phone:"",address:""},other:{date:"",container_type_id:"",title:"",akey:"",destination_name:"",destination_id:"",warehouse_name:""},history:[],packages:[]},this.lightboxRef=this.gallery.ref("lightbox"),this.lightboxRef.setConfig({imageSize:m.e.Contain,thumbPosition:m.f.Top,itemTemplate:this.itemTemplate,gestures:!1}),this.sub=this.route.params.subscribe(t=>{this.shipmentId=+t.id,isNaN(this.shipmentId)?(this.editMode=!1,this.shipmentHistory=null,this.shipmentId=null):(this.editMode=!0,this.getShipment(this.shipmentId))})}getShipment(t){const e=new FormData;e.append("shipment_id",t),this._shipmentService.getShipment(e).subscribe(t=>{if(t&&t.data){const e=t.data.data,i=t.data.shipper,n=t.data.receiver,a=t.data.destination,o=t.data.history,c=t.data.packages;this.info={shipper:{shipper_id:i.shipper_id,name:i.name,email:i.email,phone:i.phone,address:i.address,ein:i.ein,shipper_type_id:i.shipper_type_id},receiver:{receiver_id:n.receiver_id,name:n.name,email:n.email,phone:n.phone,address:n.address},other:{date:b(new Date(e.date)).format("DD/MM/YYYY"),container_type_id:e.container_type_id,title:parseInt(e.title),akey:parseInt(e.akey),destination_name:a.name,destination_id:a.id,warehouse_name:e.warehouse_name},history:o,packages:[]};for(let t=0;t<c.length;t++){let e=JSON.parse(c[t].data);"1"==e.type?this.info.packages.push({type:parseInt(e.type),year:e.year,model:e.model,mark:e.mark,vin:e.vin,value:e.value}):"2"==e.type&&this.info.packages.push({type:parseInt(e.type),description:e.description,value:e.value})}this._manager.getShipperTypes().subscribe(t=>{if(t){this.shipper_types=t.data;for(let t=0;t<this.shipper_types.length;t++)this.shipper_types[t].id==i.shipper_type_id&&(console.log(i.name),this.shipperType=this.shipper_types[t].name)}}),this._manager.getContainerTypes().subscribe(t=>{if(t){let i=t.data;for(let t=0;t<i.length;t++)i[t].id==e.container_type_id&&(this.containerType=i[t].name)}})}})}savePDF(){document.body.classList.add("print_mode"),this.exportAsService.save(this.exportAsConfig,"shipment_"+this.shipmentId).subscribe(()=>{setTimeout(()=>{document.body.classList.remove("print_mode")},1e3)})}printPage(){window.print()}openGallery(t){t.file.length>0&&(this.gallery_items=t.file.map(t=>new m.d({src:t,thumb:t})),this.lightboxRef.load(this.gallery_items),this.lightbox.open(0,"lightbox",{panelClass:"fullscreen"}))}openEditFiles(t){this.dialog.open(le,{data:{item:t,type:"shipment"}}).afterClosed().subscribe(t=>{})}downloadGallery(t){let e=new FormData;e.append("history_id",t.history_id),this._shipmentService.downloadHistoryItem(e).subscribe(t=>{t.history_file&&window.open(t.history_file,"_blank")},t=>{this.submitted=!1})}downloadShipmentGallery(){let t=new FormData;t.append("shipment_id",this.shipmentId.toString()),this._shipmentService.downloadHistoryItem(t).subscribe(t=>{t.history_file&&window.open(t.history_file,"_blank")},t=>{this.submitted=!1})}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(N.b),o.Ob(a.e),o.Ob(y.b),o.Ob(a.a),o.Ob(D.a),o.Ob(P.a),o.Ob(K.a),o.Ob(m.a),o.Ob(R.a))},t.\u0275cmp=o.Ib({type:t,selectors:[["app-info"]],viewQuery:function(t,e){var i;1&t&&(o.Rc(bi,!0,o.l),o.Rc(li,!0)),2&t&&(o.wc(i=o.dc())&&(e.content=i.first),o.wc(i=o.dc())&&(e.itemTemplate=i.first))},decls:11,vars:4,consts:[[1,"cs-page-header"],[4,"ngIf"],[1,"cs-right"],["mat-flat-button","",3,"routerLink"],["mat-list-icon",""],["class","cs-box","id","content",4,"ngIf"],["itemTemplate",""],["mat-flat-button","",3,"click"],[0,"xlink","href","#print_ico"],[0,"xlink","href","#pdf_ico"],["id","content",1,"cs-box"],[1,"col","col3-1"],["class","main_header",4,"ngIf"],[1,"col","col2"],[1,"cs-card"],[1,"col"],[1,"cs-plist"],[4,"ngFor","ngForOf"],["class","col",4,"ngIf"],[1,"main_header"],["class","pck1",4,"ngIf"],["class","pck2",4,"ngIf"],[1,"pck1"],[1,"pck2"],["mat-button","",1,"hdownload",3,"click"],[1,"gtable"],["mat-button","","disabled","",4,"ngIf"],["mat-button","",3,"click",4,"ngIf"],["mat-button","","disabled",""],["mat-button","",3,"click"],[3,"src"]],template:function(t,e){1&t&&(o.Ub(0,"div",0),o.Kc(1,di,4,0,"span",1),o.Ub(2,"div",2),o.Ub(3,"a",3),o.Ub(4,"mat-icon",4),o.Mc(5,"keyboard_arrow_left"),o.Tb(),o.Mc(6," Back "),o.Tb(),o.Kc(7,mi,7,0,"ng-container",1),o.Tb(),o.Tb(),o.Kc(8,Oi,100,23,"div",5),o.Kc(9,wi,1,1,"ng-template",null,6,o.Lc)),2&t&&(o.Cb(1),o.oc("ngIf",e.editMode),o.Cb(2),o.oc("routerLink","/admin/shipments/list"),o.Cb(4),o.oc("ngIf",e.shipmentId),o.Cb(1),o.oc("ngIf",e.info))},directives:[n.l,S.a,a.h,w.a,k.b,S.b,pe.a,pe.c,pe.e,pe.b,n.k,q.b],pipes:[z.a,E],styles:[".pck1[_ngcontent-%COMP%], .pck2[_ngcontent-%COMP%]{display:table;width:100%;background:#f9f9f9;border:1px solid #ececec;border-radius:5px}.pck1[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;width:20%;padding:10px 7px;border-right:1px solid #ececec;height:100%;position:relative;word-break:break-all}.pck1[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{border-right:none}.pck1[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%], .pck1[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h4[_ngcontent-%COMP%], .pck2[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%], .pck2[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h4[_ngcontent-%COMP%]{margin:0}.pck2[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;width:80%;padding:10px 7px;border-right:1px solid #ececec;height:100%;position:relative;word-break:break-all}.pck2[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{border-right:none}.pck2[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-of-type(2){width:19%}.hdownload[_ngcontent-%COMP%]{line-height:1;margin-top:-10px;min-width:20px;padding:0 10px}@media screen and (max-width:900px){.pck1[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .pck2[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;width:100%;margin-bottom:10px}.pck2[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-of-type(2){width:100%}.cs-plist[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:20px}.cs-plist[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{margin-bottom:0}}"]}),t})()}];let Ii=(()=>{class t{}return t.\u0275mod=o.Mb({type:t}),t.\u0275inj=o.Lb({factory:function(e){return new(e||t)},imports:[[a.i.forChild(ki)],a.i]}),t})();var xi=i("cw5Z"),Si=i("77rt"),Fi=i("PCNd"),Ni=i("jAig"),Di=i("p8Kd"),Ki=i("usqr"),Ri=i("GL1M"),Ai=i("zRWu");let Vi=(()=>{class t{}return t.\u0275mod=o.Mb({type:t}),t.\u0275inj=o.Lb({factory:function(e){return new(e||t)},imports:[[xi.a,n.c,Ii,Ai.a,Si.a,Fi.a,Ni.a,q.a,Di.a,m.c,R.b,Ki.a,r.l,Ai.a,Ri.b,r.u]]}),t})()}}]);